<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>قوانين الأسس الصحيحة - تفاعلية</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* أنماط الصفحة التعليمية الأصلية */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d);
            color: #333;
            line-height: 1.7;
            padding: 10px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }
        
        header {
            background: linear-gradient(90deg, #3a7bd5, #00d2ff);
            color: white;
            padding: 25px;
            text-align: center;
            border-bottom: 5px solid #ffd700;
        }
        
        h1 {
            font-size: 2.3rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        .subtitle {
            font-size: 1.2rem;
            opacity: 0.95;
        }
        
        .content {
            display: flex;
            flex-direction: column;
            gap: 20px;
            padding: 20px;
        }
        
        .section {
            background-color: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
            border: 1px solid #e0e0e0;
            width: 100%;
        }
        
        .section:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
        }
        
        .section-title {
            color: #3a7bd5;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #ffd700;
            font-size: 1.7rem;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .story {
            background: linear-gradient(135deg, #f5f7fa, #e4edf9);
        }
        
        .story-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 30px;
        }
        
        .story-text {
            width: 100%;
            font-size: 1.15rem;
            line-height: 1.8;
            text-align: justify;
        }
        
        .story-image {
            width: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        /* أنماط جديدة محسّنة لصورة شارع الأعمدة الروماني */
        .roman-scene-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            height: 350px;
            margin: 0 auto;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            background: #f0e8d9; /* لون ترابي فاتح */
        }
        
        .roman-scene {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: flex-end;
            overflow: hidden;
        }
        
        .roman-sky {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 60%;
            background: linear-gradient(to top, #87ceeb 0%, #6495ed 70%, #f0e8d9 100%);
            mask-image: linear-gradient(to bottom, black 80%, transparent 100%);
        }
        
        .roman-sun {
            position: absolute;
            top: 30px;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 80px;
            background: radial-gradient(circle, #fffacd, #ffd700);
            border-radius: 50%;
            animation: sunPulse 3s infinite alternate;
            z-index: 1;
        }
        
        @keyframes sunPulse {
            0% { box-shadow: 0 0 80px 30px rgba(255, 223, 0, 0.7); }
            50% { box-shadow: 0 0 120px 50px rgba(255, 223, 0, 0.9); }
            100% { box-shadow: 0 0 80px 30px rgba(255, 223, 0, 0.7); }
        }

        /* أنماط الغيوم المحسّنة */
        .roman-cloud {
            position: absolute;
            background: transparent;
            border-radius: 50%;
            opacity: 0.9;
            filter: drop-shadow(0 5px 5px rgba(0,0,0,0.1));
            animation: floatCloud 30s infinite linear;
            z-index: 2;
        }

        .roman-cloud span {
            position: absolute;
            background: radial-gradient(circle, rgba(255, 255, 255, 1) 0%, rgba(240, 240, 240, 0.9) 100%);
            border-radius: 50%;
            box-shadow: inset 0 0 10px rgba(0,0,0,0.05);
        }
        
        .roman-cloud1 {
            top: 50px;
            left: -20%;
            width: 120px;
            height: 50px;
            animation-delay: 0s;
            animation-duration: 35s;
        }
        .roman-cloud1 span:nth-child(1) { width: 70px; height: 40px; top: 0; left: 0; }
        .roman-cloud1 span:nth-child(2) { width: 80px; height: 50px; top: 10px; left: 30px; opacity: 0.9; }
        .roman-cloud1 span:nth-child(3) { width: 60px; height: 35px; top: 5px; left: 60px; opacity: 0.8; }
        
        .roman-cloud2 {
            top: 30px;
            left: -5%;
            width: 180px;
            height: 70px;
            animation-delay: 10s;
            animation-duration: 40s;
        }
        .roman-cloud2 span:nth-child(1) { width: 100px; height: 60px; top: 0; left: 0; }
        .roman-cloud2 span:nth-child(2) { width: 120px; height: 70px; top: 15px; left: 50px; opacity: 0.9; }
        .roman-cloud2 span:nth-child(3) { width: 80px; height: 50px; top: 10px; left: 100px; opacity: 0.85; }
        .roman-cloud2 span:nth-child(4) { width: 70px; height: 45px; top: 20px; left: 130px; opacity: 0.7; }
        
        .roman-cloud3 {
            top: 80px;
            left: -15%;
            width: 140px;
            height: 60px;
            animation-delay: 20s;
            animation-duration: 30s;
        }
        .roman-cloud3 span:nth-child(1) { width: 80px; height: 50px; top: 0; left: 0; }
        .roman-cloud3 span:nth-child(2) { width: 90px; height: 60px; top: 10px; left: 40px; opacity: 0.95; }
        .roman-cloud3 span:nth-child(3) { width: 70px; height: 40px; top: 5px; left: 80px; opacity: 0.8; }
        
        @keyframes floatCloud {
            0% { transform: translateX(0) translateY(0); }
            25% { transform: translateX(25%) translateY(5px); }
            50% { transform: translateX(50%) translateY(0); }
            75% { transform: translateX(75%) translateY(-5px); }
            100% { transform: translateX(120%) translateY(0); }
        }
        
        .roman-mountains {
            position: absolute;
            bottom: 35%;
            width: 100%;
            height: 30%;
            overflow: hidden;
        }
        
        .roman-mountain {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 100%;
            background-color: transparent;
            clip-path: polygon(0 100%, 15% 40%, 30% 80%, 50% 20%, 70% 60%, 85% 30%, 100% 100%);
        }
        
        .roman-mountain1 {
            background: linear-gradient(to top, #757d8a, #565e6b);
            height: 100%;
            transform: scale(1.1) translateX(-5%);
            z-index: 5;
        }
        
        .roman-mountain2 {
            background: linear-gradient(to top, #8a929e, #6e7682);
            height: 80%;
            transform: scale(1.05) translateX(5%);
            z-index: 4;
            clip-path: polygon(0 100%, 10% 50%, 25% 90%, 45% 30%, 65% 70%, 80% 40%, 100% 100%);
        }
        
        .roman-mountain3 {
            background: linear-gradient(to top, #9fa8b4, #818a96);
            height: 60%;
            transform: scale(1) translateX(0%);
            z-index: 3;
            clip-path: polygon(0 100%, 5% 60%, 20% 95%, 40% 40%, 60% 80%, 75% 50%, 100% 100%);
        }
        
        .roman-columns-container {
            position: absolute;
            bottom: 25%;
            width: 100%;
            display: flex;
            justify-content: space-around;
            z-index: 8;
            background: transparent;
            padding: 0 20px;
            perspective: 1000px;
        }
        
        .roman-column {
            position: relative;
            width: 45px;
            height: 220px;
            display: flex;
            flex-direction: column;
            align-items: center;
            background: transparent;
            transform-style: preserve-3d;
            transform: rotateY(var(--rotation, 0deg));
            transition: transform 0.3s ease;
        }
        
        .roman-column:nth-child(1) { --rotation: -8deg; }
        .roman-column:nth-child(2) { --rotation: -4deg; }
        .roman-column:nth-child(3) { --rotation: -2deg; }
        .roman-column:nth-child(4) { --rotation: 0deg; }
        .roman-column:nth-child(5) { --rotation: 2deg; }
        .roman-column:nth-child(6) { --rotation: 4deg; }
        .roman-column:nth-child(7) { --rotation: 8deg; }
        .roman-column:nth-child(8) { --rotation: 12deg; }

        .roman-column-base {
            width: 60px;
            height: 25px;
            background: linear-gradient(to bottom, #8d6e63, #6d4c41);
            border-radius: 8px;
            box-shadow: 0 6px 18px rgba(0,0,0,0.4);
            position: relative;
            z-index: 1;
        }
        
        .roman-column-shaft {
            width: 40px;
            height: 170px;
            background: 
                repeating-linear-gradient(
                    90deg,
                    transparent 0 5px,
                    rgba(0, 0, 0, 0.1) 5px 6px
                ),
                linear-gradient(to bottom, #f0e6d6, #d4c0b0);
            border-radius: 8px;
            position: relative;
            box-shadow: inset 0 0 12px rgba(0,0,0,0.15), 0 3px 8px rgba(0,0,0,0.25);
            overflow: hidden;
            flex-grow: 1;
        }
        
        .roman-column-shaft::before, .roman-column-shaft::after {
            content: '';
            position: absolute;
            width: 100%;
            height: 6px;
            background: #b09880;
            left: 0;
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.1);
        }
        
        .roman-column-shaft::before { top: 10px; }
        .roman-column-shaft::after { bottom: 10px; }
        
        .roman-column-capital {
            width: 55px;
            height: 25px;
            background: linear-gradient(to bottom, #e0c8b0, #c8b098);
            border-radius: 10px 10px 5px 5px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.35);
            position: relative;
            z-index: 2;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .roman-column-ornament {
            position: absolute;
            top: -7px;
            left: 50%;
            transform: translateX(-50%);
            width: 45px;
            height: 18px;
            background: linear-gradient(to bottom, #f0e6d6, #e0c8b0);
            border-radius: 8px;
            box-shadow: 
                0 0 12px rgba(0, 0, 0, 0.3),
                0 5px 10px rgba(0, 0, 0, 0.3),
                inset 0 1px 5px rgba(255, 255, 255, 0.25);
            z-index: 3;
            border: 1px solid rgba(0,0,0,0.15);
        }
        
        .roman-column-detail {
            position: absolute;
            width: calc(100% - 12px);
            height: 10px;
            background: #b09880;
            top: 10px;
            left: 6px;
            border-radius: 4px;
            box-shadow: inset 0 2px 5px rgba(0,0,0,0.15);
        }
        
        .roman-ornament-top {
            position: absolute;
            top: -15px;
            left: 50%;
            transform: translateX(-50%);
            width: 25px;
            height: 25px;
            background: linear-gradient(to bottom, #e0c8b0, #c8b098); 
            border-radius: 50%;
            box-shadow: 
                0 2px 5px rgba(0, 0, 0, 0.3),
                inset 0 1px 3px rgba(255, 255, 255, 0.2);
            z-index: 4;
            border: 1px solid rgba(0,0,0,0.1);
        }
        
        .roman-street {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 35%;
            background: linear-gradient(to bottom, #8d6e63, #5d4037);
            display: flex;
            justify-content: center;
            align-items: flex-end;
            z-index: 3;
        }
        
        .roman-road {
            width: 90%;
            height: 65%;
            background: transparent;
            position: relative;
            overflow: hidden;
            border-radius: 8px 8px 0 0;
            perspective: 500px;
            transform-style: preserve-3d;
        }
        
        .roman-road-stones {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(40px, 1fr));
            grid-auto-rows: 45px;
            gap: 4px;
            z-index: 1;
            transform: rotateX(60deg) translateY(50px);
            transform-origin: bottom center;
        }
        
        .roman-stone:nth-child(odd) {
            background: linear-gradient(45deg, #4e342e, #3e2723);
        }
        
        .roman-stone:nth-child(3n) {
            background: linear-gradient(45deg, #6d4c41, #5d4037);
        }
        
        .roman-road-line {
            position: absolute;
            top: 50%;
            width: 100%;
            height: 6px;
            background: linear-gradient(90deg, transparent, #ffd54f, transparent);
            transform: translateY(-50%);
            animation: roadLine 3s linear infinite;
            z-index: 2;
        }
        
        /* تحسين مظهر المصور */
        .roman-photographer {
            position: absolute;
            bottom: 25%;
            left: 45%;
            z-index: 15;
            transform-origin: bottom center;
            animation: bobbing 4s infinite ease-in-out; /* حركة خفيفة للمصور */
        }
        
        @keyframes bobbing {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }

        .roman-person {
            position: relative;
            width: 40px; /* عرض أكبر قليلاً */
            height: 80px; /* طول أكبر قليلاً */
        }
        
        .roman-head {
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 25px; /* رأس أكبر */
            height: 25px; /* رأس أكبر */
            background: linear-gradient(to bottom, #ffccbc, #e0b7a7);
            border-radius: 50% 50% 40% 40%; /* شكل أكثر طبيعية للرأس */
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            z-index: 2;
        }
        
        .roman-body {
            position: absolute;
            top: 22px; /* أسفل الرأس بقليل */
            left: 50%;
            transform: translateX(-50%);
            width: 30px; /* جسم أعرض */
            height: 40px; /* جسم أطول */
            background: linear-gradient(to bottom, #2196f3, #1976d2);
            border-radius: 15px 15px 8px 8px; /* شكل جسم أكثر نعومة */
            box-shadow: 0 3px 8px rgba(0,0,0,0.2);
            z-index: 1;
        }
        
        .roman-leg {
            position: absolute;
            bottom: 0;
            width: 10px; /* أرجل أعرض */
            height: 38px; /* أرجل أطول */
            background: linear-gradient(to bottom, #1565c0, #0d47a1);
            border-radius: 5px;
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.2);
        }
        
        .roman-leg-left {
            left: 5px;
            transform: rotate(-5deg); /* حركة بسيطة */
        }
        
        .roman-leg-right {
            right: 5px;
            transform: rotate(5deg); /* حركة بسيطة */
        }
        
        .roman-arm {
            position: absolute;
            top: 28px; /* موضع الذراع */
            width: 8px; /* ذراع أعرض */
            height: 30px; /* ذراع أطول */
            background: linear-gradient(to bottom, #1976d2, #1565c0);
            border-radius: 4px;
            transform-origin: top center;
        }
        
        .roman-arm-left {
            left: -10px; /* موضع الذراع الأيسر */
            transform: rotate(-30deg); /* وضعية حمل الكاميرا */
        }
        
        .roman-arm-right {
            right: -10px; /* موضع الذراع الأيمن */
            transform: rotate(30deg); /* وضعية حمل الكاميرا */
        }
        
        .roman-camera {
            position: absolute;
            top: 20px; /* موضع الكاميرا بالنسبة للمصور */
            left: -25px; /* موضع الكاميرا بالنسبة للمصور */
            width: 35px; /* كاميرا أعرض */
            height: 25px; /* كاميرا أطول */
            background: linear-gradient(45deg, #212121, #000);
            border-radius: 8px;
            transform-style: preserve-3d;
            box-shadow: 0 5px 15px rgba(0,0,0,0.4);
            transform: rotateY(-10deg); /* منظور خفيف */
        }
        
        .roman-camera-lens {
            position: absolute;
            top: 5px;
            left: 5px;
            width: 15px; /* عدسة أكبر */
            height: 15px; /* عدسة أكبر */
            background: radial-gradient(circle, #64b5f6, #1e88e5);
            border-radius: 50%;
            border: 3px solid #0d47a1; /* حدود أسمك */
            box-shadow: inset 0 0 5px rgba(0,0,0,0.5);
        }
        
        .roman-camera-strap {
            position: absolute;
            top: 10px;
            left: 30px; /* موضع الحزام */
            width: 5px; /* حزام أعرض */
            height: 35px; /* حزام أطول */
            background: #795548;
            border-radius: 3px;
            transform: rotate(-20deg);
        }
        
        .roman-flash {
            position: absolute;
            top: -10px; /* موضع الفلاش */
            left: 10px; /* موضع الفلاش */
            width: 8px; /* فلاش أكبر */
            height: 8px; /* فلاش أكبر */
            background: radial-gradient(circle, #ffff00, #ffd600);
            border-radius: 50%;
            opacity: 0; /* مخفي في البداية */
            box-shadow: 0 0 10px #ffd600;
            animation: flashEffect 3s infinite ease-out 5s; /* حركة الفلاش */
        }

        /* تعريف حركة الفلاش */
        @keyframes flashEffect {
            0%, 100% { opacity: 0; transform: scale(0.8); } /* مخفي وصغير */
            5% { opacity: 1; transform: scale(1.2); box-shadow: 0 0 20px 5px #ffd600; } /* يظهر ويتوهج */
            10% { opacity: 0; transform: scale(0.8); } /* يختفي بسرعة */
        }
        
        .roman-plants {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 35%;
            z-index: 2;
        }
        
        .roman-plant {
            position: absolute;
            bottom: 0;
            height: 35px;
        }
        
        .roman-plant-stem {
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 4px;
            height: 25px;
            background: linear-gradient(to bottom, #4caf50, #2e7d32);
        }
        
        .roman-plant-leaf {
            position: absolute;
            width: 15px;
            height: 12px;
            background: linear-gradient(to bottom, #81c784, #4caf50);
            border-radius: 50%;
            z-index: 1;
        }
        
        .roman-plant-left {
            left: 10%;
        }
        
        .roman-plant-right {
            right: 10%;
        }
        
        .roman-flower {
            position: absolute;
            bottom: 25px;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            z-index: 1;
            filter: drop-shadow(0 5px 5px rgba(0,0,0,0.1));
        }
        
        .roman-flower-petal {
            position: absolute;
            width: 7px;
            height: 7px;
            background: linear-gradient(45deg, #f48fb1, #f06292);
            border-radius: 50%;
        }
        
        .roman-flower-center {
            position: absolute;
            top: 5.5px;
            left: 5.5px;
            width: 7px;
            height: 7px;
            background: radial-gradient(circle, #ffd54f, #ffb300);
            border-radius: 50%;
            z-index: 2;
        }
        
        .roman-flower1 { left: 15%; }
        .roman-flower2 { left: 30%; }
        .roman-flower3 { left: 50%; }
        .roman-flower4 { left: 70%; }
        .roman-flower5 { left: 85%; }
        
        @keyframes roadLine {
            0% { transform: translateY(-50%) translateX(0); }
            100% { transform: translateY(-50%) translateX(-60px); }
        }
        
        /* بقية أنماط الصفحة التعليمية */
        .table-section {
            background: linear-gradient(135deg, #f0f9ff, #e0f7fa);
            overflow-x: auto;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            font-size: 1.1rem;
        }
        
        th {
            background: linear-gradient(90deg, #3a7bd5, #00d2ff);
            color: white;
            padding: 15px;
            text-align: center;
            font-size: 1.2rem;
        }
        
        td {
            padding: 12px;
            text-align: center;
            border-bottom: 1px solid #ddd;
            font-size: 1.1rem;
        }
        
        tr:nth-child(even) {
            background-color: #f8f9fa;
        }
        
        tr:hover {
            background-color: #e3f2fd;
        }
        
        .interactive-controls {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-top: 20px;
        }
        
        input {
            padding: 14px;
            border: 2px solid #3a7bd5;
            border-radius: 8px;
            font-size: 1.1rem;
            width: 100%;
            /* لمنع ظهور لوحة المفاتيح الافتراضية على بعض الأجهزة */
            /* text-transform: uppercase; */
        }
        
        button {
            padding: 14px;
            background: linear-gradient(90deg, #3a7bd5, #00d2ff);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: bold;
            transition: all 0.3s ease;
            width: 100%;
        }
        
        button:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            background: linear-gradient(90deg, #00d2ff, #3a7bd5);
        }
        
        .result {
            margin-top: 20px;
            padding: 15px;
            background-color: #e8f5e9;
            border-radius: 8px;
            border-left: 5px solid #4caf50;
            font-size: 1.1rem;
            display: none;
        }
        
        .examples {
            background: linear-gradient(135deg, #fffde7, #fff9c4);
        }
        
        .example {
            margin: 20px 0;
            padding: 20px;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08);
        }
        
        .example-title {
            color: #ff9800;
            margin-bottom: 15px;
            font-size: 1.3rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .example-content {
            font-size: 1.15rem;
            margin-bottom: 15px;
            padding: 12px;
            background-color: #f9f9f9;
            border-radius: 8px;
            border-left: 3px solid #ff9800;
        }
        
        .solution {
            padding: 15px;
            background-color: #f5f5f5;
            border-radius: 8px;
            margin-top: 15px;
            display: none;
            font-size: 1.05rem;
            border-left: 3px solid #4caf50;
        }
        
        .toggle-btn {
            background: linear-gradient(90deg, #ff9800, #ff5722);
            margin-top: 10px;
        }
        
        .practice {
            background: linear-gradient(135deg, #e8f5e9, #c8e6c9);
        }
        
        .exercise {
            margin: 15px 0;
            padding: 15px;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08);
        }
        
        .exercise-title {
            color: #4caf50;
            margin-bottom: 12px;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .exercise-content {
            font-size: 1.15rem;
            margin-bottom: 15px;
            padding: 12px;
            background-color: #f9f9f9;
            border-radius: 8px;
            border-left: 3px solid #4caf50;
        }
        
        .exercise-input {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .check-btn {
            background: linear-gradient(90deg, #4caf50, #2e7d32);
        }
        
        .feedback {
            margin-top: 12px;
            padding: 12px;
            border-radius: 8px;
            display: none;
            font-weight: bold;
            font-size: 1.05rem;
        }
        
        .correct {
            background-color: #e8f5e9;
            border-left: 5px solid #4caf50;
            color: #2e7d32;
        }
        
        .incorrect {
            background-color: #ffebee;
            border-left: 5px solid #f44336;
            color: #d32f2f;
        }
        
        .highlight {
            background: linear-gradient(120deg, rgba(255,215,0,0.3), rgba(255,215,0,0));
            padding: 4px 8px;
            border-radius: 6px;
            font-weight: bold;
        }
        
        footer {
            text-align: center;
            padding: 20px;
            background: linear-gradient(90deg, #3a7bd5, #00d2ff);
            color: white;
            font-size: 1rem;
            display: flex; /* لجعل الزر في سطر واحد مع النص */
            flex-direction: column; /* لجعل العناصر تتكدس عموديًا */
            align-items: center; /* لتوسيط العناصر */
            gap: 15px; /* مسافة بين العناصر */
        }

        .next-page-btn {
            display: inline-block; /* ليتصرف كزر */
            padding: 12px 25px;
            background: linear-gradient(90deg, #ffd700, #ff8c00); /* لون ذهبي مميز */
            color: #333; /* لون نص داكن ليبرز على الذهبي */
            text-decoration: none; /* إزالة خط تحت الرابط */
            border-radius: 8px;
            font-weight: bold;
            font-size: 1.1rem;
            transition: all 0.3s ease;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }

        .next-page-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.3);
            background: linear-gradient(90deg, #ff8c00, #ffd700);
            color: white; /* تغيير لون النص عند التحويم */
        }
        
        .math-expression {
            font-family: 'Cambria Math', serif;
            font-size: 1.3rem;
            text-align: center;
            margin: 20px 0;
            padding: 12px;
            background-color: #f9f9f9;
            border-radius: 10px;
            border: 2px dashed #3a7bd5;
        }
        
        /* New styles for Math Keyboard */
        .math-keyboard {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            width: 100%;
            background-color: #f0f8ff; /* Light blue background */
            border-top: 2px solid #3a7bd5;
            box-shadow: 0 -5px 20px rgba(0, 0, 0, 0.3);
            padding: 10px;
            z-index: 1000;
            display: none; /* Initially hidden */
            transition: transform 0.3s ease-out;
            transform: translateY(100%); /* Start off-screen */
        }

        .math-keyboard.active {
            display: block;
            transform: translateY(0);
        }

        .keypad-grid {
            display: grid;
            grid-template-columns: repeat(6, 1fr); /* 6 columns for mobile */
            gap: 8px;
            max-width: 600px;
            margin: 0 auto;
        }

        .keypad-button {
            background: linear-gradient(135deg, #ffffff, #e6e6e6);
            color: #333;
            border: 1px solid #ccc;
            border-radius: 8px;
            padding: 8px 5px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s ease;
            user-select: none; /* Prevent text selection */
            min-height: 40px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .keypad-button:hover {
            background: #cce7ff;
            border-color: #3a7bd5;
            transform: scale(1.05);
        }

        .keypad-button.exponent-key {
            background: linear-gradient(135deg, #fff9c4, #ffd700);
            color: #333;
            border-color: #ff9800;
            font-size: 0.9rem; /* Smaller for better fit */
        }

        .keypad-button.op-key {
            background: linear-gradient(135deg, #e3f2fd, #bbdefb);
            color: #3a7bd5;
            border-color: #64b5f6;
        }

        .keypad-button.variable-key {
            background: linear-gradient(135deg, #fce4ec, #f48fb1);
            color: #d81b60;
            border-color: #ec407a;
            text-transform: lowercase;
        }

        .keypad-button.delete-key {
            background: linear-gradient(135deg, #ffcdd2, #e57373);
            color: #d32f2f;
            border-color: #e53935;
            font-size: 1.2rem;
        }
        
        /* تحسينات للهواتف */
        @media (max-width: 768px) {
            header {
                padding: 20px;
            }
            
            h1 {
                font-size: 1.8rem;
            }
            
            .section {
                padding: 20px;
            }
            
            .section-title {
                font-size: 1.5rem;
            }
            
            .math-expression {
                font-size: 1.1rem;
            }
            
            table {
                font-size: 1rem;
            }
            
            th, td {
                padding: 10px;
            }
            
            /* Add padding at the bottom to prevent content from being hidden by the fixed keyboard */
            .container {
                padding-bottom: 120px; 
            }
        }
        
        @media (max-width: 480px) {
            header {
                padding: 15px;
            }
            
            h1 {
                font-size: 1.5rem;
            }
            
            .subtitle {
                font-size: 1rem;
            }
            
            .section {
                padding: 15px;
            }
            
            .section-title {
                font-size: 1.3rem;
            }
            
            table {
                font-size: 0.9rem;
            }
            
            th, td {
                padding: 8px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-calculator"></i> قوانين الأسس الصحيحة</h1>
            <p class="subtitle">تعلم قواعد الأسس بطريقة تفاعلية ممتعة</p>
        </header>
        
        <div class="content">
            <div class="section story">
                <h2 class="section-title"><i class="fas fa-book-open"></i> القصة: انتشار الصور</h2>
                <div class="story-content">
                    <div class="story-text">
                        <p>زار أحمد مدينة جرش، وأرسل صورة إلى اثنين من أصدقائه بعد دقيقة من التقاطها.</p>
                        <p>وبعد دقيقة أخرى أرسل كل من صديقيه الصورة نفسها إلى اثنين من أصدقائهما.</p>
                        <p>واستمرت العملية وفق هذا النمط كما في الجدول المجاور.</p>
                        <p class="highlight">السؤال: ما عدد الصور المرسلة بعد 9 دقائق؟</p>
                    </div>
                    <div class="story-image">
                        <div class="roman-scene-container">
                            <div class="roman-scene">
                                <div class="roman-sky">
                                    <div class="roman-sun"></div>
                                    <div class="roman-cloud roman-cloud1">
                                        <span></span><span></span><span></span>
                                    </div>
                                    <div class="roman-cloud roman-cloud2">
                                        <span></span><span></span><span></span><span></span>
                                    </div>
                                    <div class="roman-cloud roman-cloud3">
                                        <span></span><span></span><span></span>
                                    </div>
                                </div>
                                
                                <div class="roman-mountains">
                                    <div class="roman-mountain roman-mountain3"></div>
                                    <div class="roman-mountain roman-mountain2"></div>
                                    <div class="roman-mountain roman-mountain1"></div>
                                </div>
                                
                                <div class="roman-columns-container">
                                    <div class="roman-column">
                                        <div class="roman-column-capital">
                                            <div class="roman-column-ornament"></div>
                                            <div class="roman-ornament-top"></div>
                                            <div class="roman-column-detail"></div>
                                        </div>
                                        <div class="roman-column-shaft"></div>
                                        <div class="roman-column-base"></div>
                                    </div>
                                    
                                    <div class="roman-column">
                                        <div class="roman-column-capital">
                                            <div class="roman-column-ornament"></div>
                                            <div class="roman-ornament-top"></div>
                                            <div class="roman-column-detail"></div>
                                        </div>
                                        <div class="roman-column-shaft"></div>
                                        <div class="roman-column-base"></div>
                                    </div>
                                    
                                    <div class="roman-column">
                                        <div class="roman-column-capital">
                                            <div class="roman-column-ornament"></div>
                                            <div class="roman-ornament-top"></div>
                                            <div class="roman-column-detail"></div>
                                        </div>
                                        <div class="roman-column-shaft"></div>
                                        <div class="roman-column-base"></div>
                                    </div>
                                    
                                    <div class="roman-column">
                                        <div class="roman-column-capital">
                                            <div class="roman-column-ornament"></div>
                                            <div class="roman-ornament-top"></div>
                                            <div class="roman-column-detail"></div>
                                        </div>
                                        <div class="roman-column-shaft"></div>
                                        <div class="roman-column-base"></div>
                                    </div>
                                    
                                    <div class="roman-column">
                                        <div class="roman-column-capital">
                                            <div class="roman-column-ornament"></div>
                                            <div class="roman-ornament-top"></div>
                                            <div class="roman-column-detail"></div>
                                        </div>
                                        <div class="roman-column-shaft"></div>
                                        <div class="roman-column-base"></div>
                                    </div>
                                    
                                    <div class="roman-column">
                                        <div class="roman-column-capital">
                                            <div class="roman-column-ornament"></div>
                                            <div class="roman-ornament-top"></div>
                                            <div class="roman-column-detail"></div>
                                        </div>
                                        <div class="roman-column-shaft"></div>
                                        <div class="roman-column-base"></div>
                                    </div>
                                    
                                    <div class="roman-column">
                                        <div class="roman-column-capital">
                                            <div class="roman-column-ornament"></div>
                                            <div class="roman-ornament-top"></div>
                                            <div class="roman-column-detail"></div>
                                        </div>
                                        <div class="roman-column-shaft"></div>
                                        <div class="roman-column-base"></div>
                                    </div>
                                    
                                    <div class="roman-column">
                                        <div class="roman-column-capital">
                                            <div class="roman-column-ornament"></div>
                                            <div class="roman-ornament-top"></div>
                                            <div class="roman-column-detail"></div>
                                        </div>
                                        <div class="roman-column-shaft"></div>
                                        <div class="roman-column-base"></div>
                                    </div>
                                </div>
                                
                                <div class="roman-street">
                                    <div class="roman-road">
                                        <div class="roman-road-stones">
                                            <div class="roman-stone"></div><div class="roman-stone"></div><div class="roman-stone"></div><div class="roman-stone"></div><div class="roman-stone"></div>
                                            <div class="roman-stone"></div><div class="roman-stone"></div><div class="roman-stone"></div><div class="roman-stone"></div><div class="roman-stone"></div>
                                            <div class="roman-stone"></div><div class="roman-stone"></div><div class="roman-stone"></div><div class="roman-stone"></div><div class="roman-stone"></div>
                                            <div class="roman-stone"></div><div class="roman-stone"></div><div class="roman-stone"></div><div class="roman-stone"></div><div class="roman-stone"></div>
                                        </div>
                                        <div class="roman-road-line"></div>
                                    </div>
                                </div>
                                
                                <div class="roman-photographer">
                                    <div class="roman-person">
                                        <div class="roman-head"></div>
                                        <div class="roman-body"></div>
                                        <div class="roman-leg roman-leg-left"></div>
                                        <div class="roman-leg roman-leg-right"></div>
                                        <div class="roman-arm roman-arm-left"></div>
                                        <div class="roman-arm roman-arm-right"></div>
                                        <div class="roman-camera">
                                            <div class="roman-camera-strap"></div>
                                            <div class="roman-camera-lens"></div>
                                            <div class="roman-flash"></div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="roman-plants">
                                    <div class="roman-plant roman-plant-left">
                                        <div class="roman-plant-stem"></div>
                                        <div class="roman-plant-leaf" style="top: 8px; left: -6px; transform: rotate(-20deg);"></div>
                                        <div class="roman-plant-leaf" style="top: 16px; right: -6px; transform: rotate(20deg);"></div>
                                        <div class="roman-plant-leaf" style="top: 24px; left: -4px; transform: rotate(-10deg);"></div>
                                    </div>
                                    
                                    <div class="roman-plant roman-plant-right">
                                        <div class="roman-plant-stem"></div>
                                        <div class="roman-plant-leaf" style="top: 4px; left: -6px; transform: rotate(-25deg);"></div>
                                        <div class="roman-plant-leaf" style="top: 12px; right: -6px; transform: rotate(25deg);"></div>
                                        <div class="roman-plant-leaf" style="top: 20px; left: -5px; transform: rotate(-15deg);"></div>
                                        <div class="roman-plant-leaf" style="top: 28px; right: -4px; transform: rotate(15deg);"></div>
                                    </div>
                                    
                                    <div class="roman-flower roman-flower1">
                                        <div class="roman-flower-petal" style="top: 0; left: 5.5px;"></div>
                                        <div class="roman-flower-petal" style="top: 5.5px; left: 0;"></div>
                                        <div class="roman-flower-petal" style="top: 5.5px; left: 11px;"></div>
                                        <div class="roman-flower-petal" style="top: 11px; left: 5.5px;"></div>
                                        <div class="roman-flower-center"></div>
                                    </div>
                                    
                                    <div class="roman-flower roman-flower2">
                                        <div class="roman-flower-petal" style="top: 0; left: 5.5px;"></div>
                                        <div class="roman-flower-petal" style="top: 5.5px; left: 0;"></div>
                                        <div class="roman-flower-petal" style="top: 5.5px; left: 11px;"></div>
                                        <div class="roman-flower-petal" style="top: 11px; left: 5.5px;"></div>
                                        <div class="roman-flower-center"></div>
                                    </div>
                                    
                                    <div class="roman-flower roman-flower3">
                                        <div class="roman-flower-petal" style="top: 0; left: 5.5px;"></div>
                                        <div class="roman-flower-petal" style="top: 5.5px; left: 0;"></div>
                                        <div class="roman-flower-petal" style="top: 5.5px; left: 11px;"></div>
                                        <div class="roman-flower-petal" style="top: 11px; left: 5.5px;"></div>
                                        <div class="roman-flower-center"></div>
                                    </div>
                                    
                                    <div class="roman-flower roman-flower4">
                                        <div class="roman-flower-petal" style="top: 0; left: 5.5px;"></div>
                                        <div class="roman-flower-petal" style="top: 5.5px; left: 0;"></div>
                                        <div class="roman-flower-petal" style="top: 5.5px; left: 11px;"></div>
                                        <div class="roman-flower-petal" style="top: 11px; left: 5.5px;"></div>
                                        <div class="roman-flower-center"></div>
                                    </div>
                                    
                                    <div class="roman-flower roman-flower5">
                                        <div class="roman-flower-petal" style="top: 0; left: 5.5px;"></div>
                                        <div class="roman-flower-petal" style="top: 5.5px; left: 0;"></div>
                                        <div class="roman-flower-petal" style="top: 5.5px; left: 11px;"></div>
                                        <div class="roman-flower-petal" style="top: 11px; left: 5.5px;"></div>
                                        <div class="roman-flower-center"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="section table-section">
                <h2 class="section-title"><i class="fas fa-table"></i> جدول انتشار الصور</h2>
                <table>
                    <thead>
                        <tr>
                            <th>الدقائق</th>
                            <th>العمليات</th>
                            <th>عدد الصور المرسلة</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>1</td>
                            <td>2 × 1</td>
                            <td>2</td>
                        </tr>
                        <tr>
                            <td>2</td>
                            <td>2 × 2</td>
                            <td>4</td>
                        </tr>
                        <tr>
                            <td>3</td>
                            <td>2 × 2 × 2</td>
                            <td>8</td>
                        </tr>
                        <tr>
                            <td>4</td>
                            <td>2 × 2 × 2 × 2</td>
                            <td>16</td>
                        </tr>
                    </tbody>
                </table>
                
                <div class="interactive-controls">
                    <input type="number" id="minutes" placeholder="أدخل عدد الدقائق" min="1" max="15" value="9">
                    <button id="calculate-btn">احسب عدد الصور</button>
                </div>
                
                <div id="result" class="result">
                    <p>بعد <span id="result-minutes">9</span> دقائق، سيكون عدد الصور المرسلة:</p>
                    <p><span id="result-expression">2 × 2 × 2 × 2 × 2 × 2 × 2 × 2 × 2</span> = <span id="result-value">512</span></p>
                    <p>ويمكن كتابتها بالصيغة الأسية: 2<span id="result-exponent">⁹</span></p>
                </div>
            </div>
            
            <div class="section">
                <h2 class="section-title"><i class="fas fa-lightbulb"></i> فكرة الدرس</h2>
                <p>يمكنني التعبير عن الضرب المتكرر للعدد في نفسه باستخدام الأسس، وعندئذ يسمى عدد مرات تكرار الضرب الأس (Exponent)، ويسمى كل من الأساس والأس معًا القوة (Power).</p>
                
                <div class="math-expression">
                    2 × 2 × 2 × 2 × 2 = 2<sup>5</sup> = 32
                </div>
                
                <p><span class="highlight">الأساس:</span> العدد الذي يتم تكرار ضربه في نفسه (في هذا المثال: 2)</p>
                <p><span class="highlight">الأس:</span> عدد مرات تكرار الضرب (في هذا المثال: 5)</p>
                
                <h3 style="margin: 20px 0 10px; color: #3a7bd5; display: flex; align-items: center; gap: 10px;">
                    <i class="fas fa-bookmark"></i> المصطلحات:
                </h3>
                <ul style="list-style-type: none; padding-left: 25px; font-size: 1.1rem;">
                    <li><i class="fas fa-arrow-right"></i> أساس (Base)</li>
                    <li><i class="fas fa-arrow-right"></i> أس (Exponent)</li>
                    <li><i class="fas fa-arrow-right"></i> الصيغة الأسية (Exponential Form)</li>
                    <li><i class="fas fa-arrow-right"></i> الصيغة القياسية (Standard Form)</li>
                </ul>
            </div>
            
            <div class="section examples">
                <h2 class="section-title"><i class="fas fa-book"></i> أمثلة توضيحية</h2>
                
                <div class="example">
                    <h3 class="example-title"><i class="fas fa-pen"></i> مثال 1</h3>
                    <p class="example-content">أكتب بالصيغة الأسية: 3 × 3 × 3 × 3 × 5 × 5</p>
                    <button class="toggle-btn">عرض الحل</button>
                    <div class="solution">
                        <p>الخطوات:</p>
                        <p>3 × 3 × 3 × 3 × 5 × 5 = (3 × 3 × 3 × 3) × (5 × 5) <span class="highlight">(الخاصية التجميعية)</span></p>
                        <p>= 3<sup>4</sup> × 5<sup>2</sup></p>
                    </div>
                </div>
                
                <div class="example">
                    <h3 class="example-title"><i class="fas fa-pen"></i> مثال 2</h3>
                    <p class="example-content">أكتب بالصيغة الأسية: a × a × c × a × c × c × a × a</p>
                    <button class="toggle-btn">عرض الحل</button>
                    <div class="solution">
                        <p>الخطوات:</p>
                        <p>a × a × c × a × c × c × a × a = a × a × a × a × a × c × c × c <span class="highlight">(الخاصية التبديلية)</span></p>
                        <p>= (a × a × a × a × a) × (c × c × c) <span class="highlight">(الخاصية التجميعية)</span></p>
                        <p>= a<sup>5</sup> × c<sup>3</sup></p>
                    </div>
                </div>
            </div>
            
            <div class="section practice">
                <h2 class="section-title"><i class="fas fa-check-circle"></i> أتحقق من فهمي</h2>
                
                <div class="exercise">
                    <h3 class="exercise-title"><i class="fas fa-question-circle"></i> التمرين 1</h3>
                    <p class="exercise-content">أكتب بالصيغة الأسية: 6 × 6 × 6 × 2 × 2 × 2</p>
                    <div class="exercise-input">
                        <!-- تم إضافة خاصية type="text" لضمان عمل لوحة المفاتيح الرياضية -->
                        <input type="text" class="answer-input" placeholder="أدخل الإجابة (مثل: 6³ × 2³)">
                        <button class="check-btn">تحقق</button>
                    </div>
                    <div class="feedback"></div>
                </div>
                
                <div class="exercise">
                    <h3 class="exercise-title"><i class="fas fa-question-circle"></i> التمرين 2</h3>
                    <p class="exercise-content">أكتب بالصيغة الأسية: 8 × 8 × 8 × 8 × 7 × 7</p>
                    <div class="exercise-input">
                        <input type="text" class="answer-input" placeholder="أدخل الإجابة (مثل: 8⁴ × 7²)">
                        <button class="check-btn">تحقق</button>
                    </div>
                    <div class="feedback"></div>
                </div>
                
                <div class="exercise">
                    <h3 class="exercise-title"><i class="fas fa-question-circle"></i> التمرين 3</h3>
                    <p class="exercise-content">أكتب بالصيغة الأسية: b × b × r × b × r × b</p>
                    <div class="exercise-input">
                        <input type="text" class="answer-input" placeholder="أدخل الإجابة (مثل: b⁴ × r²)">
                        <button class="check-btn">تحقق</button>
                    </div>
                    <div class="feedback"></div>
                </div>
                
                <div class="exercise">
                    <h3 class="exercise-title"><i class="fas fa-question-circle"></i> التمرين 4</h3>
                    <p class="exercise-content">أكتب بالصيغة الأسية: d × c × c × d × c × d × d</p>
                    <div class="exercise-input">
                        <input type="text" class="answer-input" placeholder="أدخل الإجابة (مثل: c³ × d⁴)">
                        <button class="check-btn">تحقق</button>
                    </div>
                    <div class="feedback"></div>
                </div>
            </div>
        </div>
        
        <footer>
            <p> الصف السابع _ الرياضيات </p>
            <p>الصفحة 1_ قوانين الأسس الصحيحة</p>
            <a href="u2l1p2.html" class="next-page-btn">الصفحة التالية <i class="fas fa-arrow-left"></i></a>
        </footer>
    </div>
    
    <!-- لوحة المفاتيح الرياضية الجديدة -->
    <div class="math-keyboard" id="math-keyboard">
        <div class="keypad-grid">
            <!-- Exponents - نستخدم رموز يونيكود لضمان التوافق مع التحقق -->
            <button class="keypad-button exponent-key" data-char="²">x²</button>
            <button class="keypad-button exponent-key" data-char="³">x³</button>
            <button class="keypad-button exponent-key" data-char="⁴">x⁴</button>
            
            <!-- Variables/Numbers -->
            <button class="keypad-button variable-key" data-char="a">a</button>
            <button class="keypad-button variable-key" data-char="b">b</button>
            <button class="keypad-button variable-key" data-char="c">c</button>

            <!-- Operations -->
            <button class="keypad-button op-key" data-char="×">×</button>
            <button class="keypad-button op-key" data-char="/">÷</button>
            <button class="keypad-button op-key" data-char="(">(</button>
            
            <!-- More Variables/Numbers -->
            <button class="keypad-button variable-key" data-char="d">d</button>
            <button class="keypad-button variable-key" data-char="r">r</button>
            <button class="keypad-button" data-char="7">7</button>
            
            <!-- Numbers/General -->
            <button class="keypad-button" data-char="2">2</button>
            <button class="keypad-button" data-char="3">3</button>
            <button class="keypad-button" data-char="4">4</button>

            <!-- Delete and More Operations -->
            <button class="keypad-button op-key" data-char=")">)</button>
            <button class="keypad-button op-key" data-char="+">+</button>
            <button class="keypad-button op-key" data-char="-">-</button>
            
            <!-- Numbers/General -->
            <button class="keypad-button" data-char="5">5</button>
            <button class="keypad-button" data-char="6">6</button>
            <button class="keypad-button" data-char="8">8</button>
            
            <!-- Delete -->
            <button class="keypad-button delete-key" data-char="DEL"><i class="fas fa-backspace"></i></button>

        </div>
    </div>

    <script>
        // تفعيل الأزرار التفاعلية
        document.addEventListener('DOMContentLoaded', function() {
            
            // --- لوحة المفاتيح الرياضية ---
            const mathKeyboard = document.getElementById('math-keyboard');
            const answerInputs = document.querySelectorAll('.answer-input');
            let activeInput = null;

            // دالة لإدخال الحرف في موضع المؤشر
            function insertAtCursor(input, text) {
                const start = input.selectionStart;
                const end = input.selectionEnd;
                const value = input.value;

                input.value = value.substring(0, start) + text + value.substring(end);
                
                // استعادة موضع المؤشر
                input.selectionStart = input.selectionEnd = start + text.length;
                input.focus();
            }

            // إظهار لوحة المفاتيح وتحديد الحقل النشط
            answerInputs.forEach(input => {
                input.addEventListener('focus', () => {
                    activeInput = input;
                    // تأخير بسيط لإعطاء الوقت للنظام لإلغاء إظهار لوحة المفاتيح الافتراضية إذا ظهرت
                    setTimeout(() => {
                        mathKeyboard.classList.add('active');
                    }, 50);
                });
            });

            // منطق الضغط على أزرار لوحة المفاتيح
            document.querySelectorAll('.keypad-button').forEach(button => {
                // منع فقدان التركيز من حقل الإدخال عند الضغط على الزر
                button.addEventListener('mousedown', (e) => {
                    e.preventDefault(); 
                });
                
                button.addEventListener('click', () => {
                    if (!activeInput) return;

                    const char = button.getAttribute('data-char');
                    
                    if (char === 'DEL') {
                        const start = activeInput.selectionStart;
                        const end = activeInput.selectionEnd;
                        const value = activeInput.value;

                        if (start > 0 || start !== end) {
                            if (start === end) {
                                // حذف حرف واحد قبل المؤشر
                                activeInput.value = value.substring(0, start - 1) + value.substring(end);
                                activeInput.selectionStart = activeInput.selectionEnd = start - 1;
                            } else {
                                // حذف التحديد
                                activeInput.value = value.substring(0, start) + value.substring(end);
                                activeInput.selectionStart = activeInput.selectionEnd = start;
                            }
                        }
                    } else {
                        insertAtCursor(activeInput, char);
                    }
                    
                    // إعادة التركيز للحقل لضمان استمرار عمل لوحة المفاتيح
                    activeInput.focus(); 
                });
            });

            // إخفاء لوحة المفاتيح عند الضغط خارجها وخارج حقول الإدخال
            document.body.addEventListener('click', (e) => {
                const isInput = e.target.classList.contains('answer-input');
                const isKeypadButton = e.target.closest('.keypad-button');

                if (!isInput && !isKeypadButton) {
                    // تأخير بسيط للتأكد من اكتمال النقر على زر لوحة المفاتيح إذا كان النقر مرتبطاً به
                    setTimeout(() => {
                        if (!mathKeyboard.contains(document.activeElement)) {
                            mathKeyboard.classList.remove('active');
                            activeInput = null;
                        }
                    }, 10);
                }
            });
            
            // --- حساب عدد الصور ---
            const calculateBtn = document.getElementById('calculate-btn');
            const minutesInput = document.getElementById('minutes');
            const resultDiv = document.getElementById('result');
            const resultMinutes = document.getElementById('result-minutes');
            const resultExpression = document.getElementById('result-expression');
            const resultValue = document.getElementById('result-value');
            const resultExponent = document.getElementById('result-exponent');
            
            calculateBtn.addEventListener('click', function() {
                const minutes = parseInt(minutesInput.value);
                if (minutes >= 1 && minutes <= 15) {
                    // حساب التعبير الرياضي
                    const expression = '2 × '.repeat(minutes).slice(0, -3);
                    const value = Math.pow(2, minutes);
                    
                    // تحديث النتيجة
                    resultMinutes.textContent = minutes;
                    resultExpression.textContent = expression;
                    resultValue.textContent = value;
                    resultExponent.textContent = minutes;
                    
                    // عرض النتيجة
                    resultDiv.style.display = 'block';
                    
                    // تمرير الصفحة إلى النتيجة
                    resultDiv.scrollIntoView({behavior: 'smooth'});
                } else {
                    // بديل لـ alert()
                    const message = 'الرجاء إدخال عدد دقائق بين 1 و 15';
                    console.error(message);
                    // يمكنك إضافة عنصر رسالة مؤقت في الواجهة بدلاً من ذلك
                }
            });
            
            // --- عرض حلول الأمثلة ---
            const toggleButtons = document.querySelectorAll('.toggle-btn');
            toggleButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const solution = this.nextElementSibling;
                    if (solution.style.display === 'block') {
                        solution.style.display = 'none';
                        this.textContent = 'عرض الحل';
                    } else {
                        solution.style.display = 'block';
                        this.textContent = 'إخفاء الحل';
                    }
                });
            });
            
            // --- التحقق من التمارين ---
            const checkButtons = document.querySelectorAll('.check-btn');
            // لاحظ أن الإجابات تستخدم رموز يونيكود للأسس (³، ²، ⁴) لتسهيل الإدخال عبر لوحة المفاتيح
            const answers = {
                0: '6³ × 2³',
                1: '8⁴ × 7²',
                2: 'b⁴ × r²',
                3: 'd⁴ × c³' 
            };
            
            // دالة لتنظيف وتوحيد الإجابة للمقارنة
            function normalizeAnswer(answer) {
                return answer.toLowerCase()
                             .replace(/ /g, '') // إزالة المسافات
                             .replace(/\*/g, '×') // توحيد رمز الضرب
                             .replace(/\^3/g, '³')
                             .replace(/\^2/g, '²')
                             .replace(/\^4/g, '⁴');
            }

            checkButtons.forEach((button, index) => {
                button.addEventListener('click', function() {
                    const input = this.parentElement.querySelector('.answer-input');
                    const feedback = this.parentElement.nextElementSibling;
                    const userAnswer = normalizeAnswer(input.value.trim());
                    
                    // توحيد الإجابات الصحيحة المحتملة للمقارنة
                    const canonicalAnswer = normalizeAnswer(answers[index]);
                    
                    // التحقق من التبديل (مثل: 6³ × 2³ أو 2³ × 6³)
                    let isCorrect = (userAnswer === canonicalAnswer);
                    
                    if (!isCorrect && index === 0) {
                         // التحقق من حالة التبديل للتمرين 1: 2³ × 6³
                         isCorrect = (userAnswer === normalizeAnswer('2³ × 6³'));
                    } else if (!isCorrect && index === 1) {
                         // التحقق من حالة التبديل للتمرين 2: 7² × 8⁴
                         isCorrect = (userAnswer === normalizeAnswer('7² × 8⁴'));
                    } else if (!isCorrect && index === 2) {
                         // التحقق من حالة التبديل للتمرين 3: r² × b⁴
                         isCorrect = (userAnswer === normalizeAnswer('r² × b⁴'));
                    } else if (!isCorrect && index === 3) {
                         // التحقق من حالة التبديل للتمرين 4: c³ × d⁴
                         isCorrect = (userAnswer === normalizeAnswer('c³ × d⁴'));
                    }

                    if (isCorrect) {
                        feedback.textContent = 'إجابة صحيحة! أحسنت!';
                        feedback.className = 'feedback correct';
                        feedback.style.display = 'block';
                    } else {
                        feedback.textContent = `الإجابة الصحيحة هي: ${answers[index]} (أو الصيغة المبدلة)`;
                        feedback.className = 'feedback incorrect';
                        feedback.style.display = 'block';
                    }
                });
            });
        });
    </script>
</body>
</html>

