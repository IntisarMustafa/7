<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø¬Ù…Ø¹ Ø§Ù„Ù…Ù‚Ø§Ø¯ÙŠØ± Ø§Ù„Ø¬Ø¨Ø±ÙŠØ© ÙˆØ·Ø±Ø­Ù‡Ø§</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <style>
        /* ØªØ¹Ø±ÙŠÙ Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø£Ù„ÙˆØ§Ù† */
        :root {
            --blue-medium: #1E88E5;
            --blue-dark: #0D47A1;
            --accent-gold: #FFD700;
        }

        /* Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø£Ø³Ø§Ø³ÙŠØ© ÙˆØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø®Ø· */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        /* ØªØµÙ…ÙŠÙ… Ø§Ù„Ø®Ù„ÙÙŠØ© Ù„Ù„Ø¬Ø³Ù… */
        body {
            background: #ffffff;
            color: #1a237e;
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        /* Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© */
        .container {
            width: 100%;
            max-width: 1200px;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            position: relative;
            z-index: 10;
            margin: 0 auto;
        }

        /* Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ØµÙØ­Ø© */
        .title {
            text-align: center;
            margin-bottom: 30px;
            z-index: 10;
            width: 100%;
        }

        /* ØªÙ… ØªØ­Ø¯ÙŠØ« Ù‡Ø°Ø§ Ø§Ù„Ù†Ù…Ø·: Ù„ÙˆÙ† Ø§Ù„Ø®Ø· Ø£ØµØ¨Ø­ Ø£Ø¨ÙŠØ¶Ù‹Ø§ Ø«Ø§Ø¨ØªÙ‹Ø§ */
        h1 {
            font-size: 3.5rem;
            color: white;
            letter-spacing: 2px;
            margin-bottom: 10px;
            background: none;
            -webkit-background-clip: unset;
            -webkit-text-fill-color: unset;
        }

        .subtitle {
            font-size: 1.3rem;
            color: #283593;
        }

        /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ø§Ù„Ù‡ÙŠØ¯Ø± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© */
        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 40px 20px;
            background: linear-gradient(135deg, var(--blue-medium) 0%, var(--blue-dark) 100%);
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(10, 35, 66, 0.3);
            color: white;
            position: relative;
            overflow: hidden;
        }
        
        header::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 5px;
            background: linear-gradient(90deg, var(--accent-gold), #f8f9fa, var(--accent-gold));
        }

        /* Decorative SVG pattern in the header background */
        header::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            /* Updated the SVG fill color to match the new color scheme */
            background: url('data:image/svg+xml;utf8,<svg width="100%" height="100%" xmlns="http://www.w3.org/2000/svg"><defs><pattern id="pattern-zigzag" patternUnits="userSpaceOnUse" width="40" height="20"><path d="M-5,10 L-5,-10 L35,-10 L35,10 M-5,10 L15,20 L35,10" stroke="%233282B8" stroke-width="2" fill="none" transform="rotate(45)" opacity="0.1" /></pattern></defs><rect width="100%" height="100%" fill="url(%23pattern-zigzag)"/></svg>');
            opacity: 0.1;
            animation: movePattern 20s linear infinite;
        }

        @keyframes movePattern {
            0% {
                background-position: 0 0;
            }
            100% {
                background-position: 40px 20px;
            }
        }
        /* ØªØµÙ…ÙŠÙ… Ø§Ù„Ø¯Ø±Ø³ */
        .lesson-content {
            background: #ffffff;
            border-radius: 15px;
            padding: 30px;
            margin: 20px 0;
            width: 100%;
            box-shadow: 0 5px 15px rgba(25, 118, 210, 0.1);
            border: 1px solid #e3f2fd;
        }

        .lesson-title {
            font-size: 2.2rem;
            color: #0d47a1;
            margin-bottom: 20px;
            text-align: center;
            padding-bottom: 15px;
            border-bottom: 2px solid #bbdefb;
        }

        .concept-box {
            background: #e3f2fd;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            border: 1px solid #bbdefb;
        }

        .concept-title {
            font-size: 1.6rem;
            color: #0d47a1;
            margin-bottom: 15px;
        }

        .concept-content {
            font-size: 1.2rem;
            line-height: 1.8;
            color: #1a237e;
        }

        .term {
            color: #1976d2;
            font-weight: bold;
        }

        .example-box {
            background: #e8f5e9;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            border: 1px solid #c8e6c9;
        }

        .example-title {
            font-size: 1.5rem;
            color: #2e7d32;
            margin-bottom: 15px;
        }

        .example-content {
            font-size: 1.3rem;
            line-height: 1.8;
            color: #1b5e20;
            text-align: center;
            padding: 15px;
        }

        /*
            *** Ø§Ù„ØªØºÙŠÙŠØ± Ù‡Ù†Ø§: ØªÙ… Ø¥Ø¶Ø§ÙØ© direction: ltr; Ù„Ø¶Ù…Ø§Ù† Ø£Ù† Ø§Ù„Ø±Ù…ÙˆØ² Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ© ØªØ¹Ø±Ø¶ Ù…Ù† Ø§Ù„ÙŠØ³Ø§Ø± Ø¥Ù„Ù‰ Ø§Ù„ÙŠÙ…ÙŠÙ†.
            */
        .math-expression {
            direction: ltr;
            font-family: 'Cambria Math', serif;
            font-size: 1.5rem;
            background: #f5f5f5;
            padding: 10px 20px;
            border-radius: 10px;
            display: inline-block;
            margin: 10px 0;
            color: #0d47a1;
            border: 1px solid #bbdefb;
            /* Ø¥Ø¶Ø§ÙØ© ØªÙ†Ø³ÙŠÙ‚ Ù„ÙŠØ¸Ù‡Ø± ÙÙŠ Ø§Ù„Ù…Ù†ØªØµÙ Ø¨Ø´ÙƒÙ„ Ø£ÙØ¶Ù„ */
            display: block;
            text-align: center;
        }
        
        .third-box-expression, .katex-display {
            direction: ltr;
        }

        /* Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ù…Ø­ÙŠØ· Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© */
        .ocean-container {
            width: 100%;
            height: 50vh;
            max-height: 500px;
            position: relative;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(13, 71, 161, 0.15);
            border: 2px solid #bbdefb;
            clip-path: polygon(0 15%, 100% 15%, 100% 100%, 0 100%);
            margin: 20px 0;
        }

        /* Ø§Ù„Ù…Ø­ÙŠØ· Ù†ÙØ³Ù‡ */
        .ocean {
            position: absolute;
            width: 100%;
            height: 100%;
            background: linear-gradient(to bottom, #2196f3, #1976d2, #0d47a1);
        }

        /* Ø§Ù„Ø£Ù…ÙˆØ§Ø¬ Ø§Ù„Ù…ØªØ­Ø±ÙƒØ© */
        .wave {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 200%;
            height: 12%;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 120" preserveAspectRatio="none"><path d="M0,0V46.29c47.79,22.2,103.59,32.17,158,28,70.36-5.37,136.33-33.31,206.8-37.5C438.64,32.43,512.34,53.67,583,72.05c69.27,18,138.3,24.88,209.4,13.08,36.15-6,69.85-17.84,104.45-29.34C989.49,25,1113-14.29,1200,52.47V0Z" opacity=".4" fill="%230d47a1"/><path d="M0,0V15.81C13,36.92,27.64,56.86,47.69,72.05,99.41,111.27,165,111,224.58,91.58c31.15-10.15,60.09-26.07,89.67-39.8,40.92-19,84.73-46,130.83-49.67,36.26-2.85,70.9,9.42,98.6,31.56,31.77,25.39,62.32,62,103.63,73,40.44,10.79,81.35-6.69,119.13-24.28s75.16-39,116.92-43.05c59.73-5.85,113.28,22.88,168.9,38.84,30.2,8.66,59,6.17,87.09-7.5,22.43-10.89,48-26.93,60.65-49.24V0Z" opacity=".6" fill="%231976d2"/><path d="M0,0V5.63C149.93,59,314.09,71.32,475.83,42.57c43-7.64,84.23-20.12,127.61-26.46,59-8.63,112.48,12.24,165.56,35.4C827.93,77.22,886,95.24,951.2,90c86.53-7,172.46-45.71,248.8-84.81V0Z" fill="%232196f3"/></svg>');
            background-size: 50% 100%;
            animation: wave 20s linear infinite;
            opacity: 0.8;
        }

        .wave-2 {
            animation: wave 15s linear infinite reverse;
            opacity: 0.6;
            height: 10%;
            bottom: 5%;
        }

        /* Ø­Ø±ÙƒØ© Ø§Ù„Ø£Ù…ÙˆØ§Ø¬ */
        @keyframes wave {
            0% {
                transform: translateX(0);
            }
            100% {
                transform: translateX(-50%);
            }
        }

        /* Ù†Ù‚Ø§Ø· Ø§Ù„Ù…Ø«Ù„Ø« (ØªÙ… Ø²ÙŠØ§Ø¯Ø© Ø­Ø¬Ù…Ù‡Ø§ ÙˆØ¸Ù„Ù‡Ø§) */
        .point {
            position: absolute;
            width: 24px;
            height: 24px;
            background: #d32f2f;
            border-radius: 50%;
            box-shadow: 0 0 15px rgba(211, 47, 47, 0.5);
            z-index: 10;
            transform: translate(-50%, -50%);
        }

        /* ØªØ£Ø«ÙŠØ± Ø§Ù„Ù†Ø¨Ø¶ Ø§Ù„Ø®Ø§Øµ Ø¨Ù†Ù‚Ø·Ø© Ø¨Ø±Ù…ÙˆØ¯Ø§ */
        .point.bermuda {
            animation: bermuda-pulse 2s infinite alternate;
        }

        @keyframes bermuda-pulse {
            0% {
                box-shadow: 0 0 15px rgba(211, 47, 47, 0.5);
                transform: translate(-50%, -50%) scale(1);
            }
            100% {
                box-shadow: 0 0 30px rgba(211, 47, 47, 0.8);
                transform: translate(-50%, -50%) scale(1.2);
            }
        }

        /* ØªØ³Ù…ÙŠØ§Øª Ø§Ù„Ù†Ù‚Ø§Ø· */
        .point-label {
            position: absolute;
            color: #0d47a1;
            font-weight: bold;
            font-size: 1.2rem;
            background: #ffffff;
            padding: 8px 20px;
            border-radius: 30px;
            border: 1px solid #bbdefb;
            box-shadow: 0 0 10px rgba(13, 71, 161, 0.1);
            z-index: 10;
            white-space: nowrap;
        }

        /* ØªØµÙ…ÙŠÙ… Ø§Ù„Ø·Ø§Ø¦Ø±Ø© Ø¨Ø§Ù„Ø¥ÙŠÙ…ÙˆØ¬ÙŠ */
        .plane {
            position: absolute;
            top: 30%;
            left: 30%;
            font-size: 3.5rem;
            animation: fly 20s infinite;
            z-index: 5;
            transform-origin: center;
            filter: drop-shadow(0 0 5px rgba(0, 0, 0, 0.3));
        }

        /* Ø­Ø±ÙƒØ© Ø§Ù„Ø·Ø§Ø¦Ø±Ø© */
        @keyframes fly {
            0%,
            100% {
                transform: translate(0, 0) rotate(0deg);
            }
            20% {
                transform: translate(15vw, 15vh) rotate(5deg);
            }
            40% {
                transform: translate(60vw, 0vh) rotate(-10deg);
            }
            60% {
                transform: translate(50vw, 30vh) rotate(8deg);
            }
            80% {
                transform: translate(10vw, 10vh) rotate(-5deg);
            }
        }

        /* Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… */
        .controls {
            display: flex;
            gap: 20px;
            margin-top: 30px;
            z-index: 10;
            justify-content: center;
            width: 100%;
            flex-wrap: wrap;
        }

        .control-btn {
            background: #0d47a1;
            border: none;
            color: #ffffff;
            padding: 12px 25px;
            border-radius: 50px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 5px 15px rgba(13, 71, 161, 0.2);
        }

        .control-btn:hover {
            background: #1565c0;
            transform: translateY(-3px);
            box-shadow: 0 7px 20px rgba(13, 71, 161, 0.3);
        }

        /* Ø²Ø± Ø§Ù„ØªØ§Ù„ÙŠ Ø§Ù„Ø¬Ø¯ÙŠØ¯ */
        .next-btn {
            background: #2e7d32;
            margin-top: 30px;
        }

        .next-btn:hover {
            background: #388e3c;
        }

        /* Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª Ø§Ù„ØºÙ…ÙˆØ¶ Ø§Ù„Ø¹Ø§Ø¦Ù…Ø© */
        .mystery-icons {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }

        .mystery-icon {
            position: absolute;
            font-size: 3rem;
            color: rgba(25, 118, 210, 0.1);
            animation: float-icon 15s infinite ease-in-out;
        }

        .mystery-icon:nth-child(1) {
            top: 20%;
            left: 10%;
            animation-delay: 0s;
        }

        .mystery-icon:nth-child(2) {
            top: 70%;
            right: 15%;
            animation-delay: -3s;
        }

        .mystery-icon:nth-child(3) {
            bottom: 30%;
            left: 25%;
            animation-delay: -5s;
        }

        .mystery-icon:nth-child(4) {
            top: 40%;
            right: 25%;
            animation-delay: -7s;
        }

        .mystery-icon:nth-child(5) {
            bottom: 20%;
            right: 30%;
            animation-delay: -9s;
        }

        /* Ø­Ø±ÙƒØ© Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª Ø§Ù„ØºÙ…ÙˆØ¶ */
        @keyframes float-icon {
            0%,
            100% {
                transform: translate(0, 0) rotate(0deg);
                opacity: 0.1;
            }
            25% {
                transform: translate(30px, -40px) rotate(15deg);
                opacity: 0.3;
            }
            50% {
                transform: translate(-20px, 30px) rotate(-10deg);
                opacity: 0.2;
            }
            75% {
                transform: translate(40px, 20px) rotate(5deg);
                opacity: 0.4;
            }
        }

        /* ØªØ£Ø«ÙŠØ± Ø§Ù„Ø¹Ù…Ù‚ */
        .depth-effect {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at center, transparent 30%, rgba(255, 255, 255, 0.8) 100%);
            pointer-events: none;
        }

        /* ÙÙ‚Ø§Ø¹Ø§Øª Ø§Ù„ØºÙ…ÙˆØ¶ */
        .bubble {
            position: absolute;
            background: rgba(33, 150, 243, 0.3);
            border-radius: 50%;
            animation: bubble-rise 10s infinite ease-in;
            box-shadow: 0 0 10px rgba(33, 150, 243, 0.3);
        }

        /* Ø­Ø±ÙƒØ© Ø§Ù„ÙÙ‚Ø§Ø¹Ø§Øª */
        @keyframes bubble-rise {
            0% {
                transform: translateY(0) scale(0.1);
                opacity: 0.5;
            }
            90% {
                opacity: 0.8;
            }
            100% {
                transform: translateY(-100vh) scale(1.5);
                opacity: 0;
            }
        }

        /* ÙˆÙ…Ø¶Ø§Øª Ø¶ÙˆØ¦ÙŠØ© ØºØ§Ù…Ø¶Ø© */
        .light-flash {
            position: absolute;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, rgba(33, 150, 243, 0.2) 0%, transparent 70%);
            opacity: 0;
            animation: flash 15s infinite;
            pointer-events: none;
        }

        /* Ø­Ø±ÙƒØ© Ø§Ù„ÙˆÙ…Ø¶Ø§Øª */
        @keyframes flash {
            0%,
            100% {
                opacity: 0;
            }
            5% {
                opacity: 0.6;
            }
            10% {
                opacity: 0;
            }
            50% {
                opacity: 0;
            }
            55% {
                opacity: 0.4;
            }
            60% {
                opacity: 0;
            }
        }

        /* Ø§Ù†Ø¹ÙƒØ§Ø³ Ø§Ù„Ù…Ø§Ø¡ */
        .water-reflection {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(to bottom, transparent 60%, rgba(25, 118, 210, 0.05) 100%);
            pointer-events: none;
            z-index: 2;
        }

        /* Ø³Ø·Ø­ Ø§Ù„Ù…Ø§Ø¡ */
        .water-surface {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.000/svg" viewBox="0 0 100 100" preserveAspectRatio="none"><path d="M0,0 L100,0 L100,100 L0,100 Z" fill="none" stroke="rgba(25,118,210,0.1)" stroke-width="1" stroke-dasharray="5,5"/></svg>');
            opacity: 0.2;
            pointer-events: none;
            z-index: 3;
        }

        /* ØªØ£Ø«ÙŠØ± Ø§Ù„Ø§Ø®ØªÙØ§Ø¡ */
        .disappear-effect {
            position: absolute;
            top: 40%;
            left: 45%;
            width: 150px;
            height: 150px;
            background: radial-gradient(circle, rgba(33, 150, 243, 0.3) 0%, transparent 70%);
            border-radius: 50%;
            animation: disappear 10s infinite;
            pointer-events: none;
            z-index: 8;
        }

        /* Ø­Ø±ÙƒØ© Ø§Ù„Ø§Ø®ØªÙØ§Ø¡ */
        @keyframes disappear {
            0%,
            100% {
                transform: scale(0.5);
                opacity: 0;
            }
            50% {
                transform: scale(1.2);
                opacity: 0.7;
            }
        }

        /* SVG Ù„Ù„ÙƒØªÙ„ Ø§Ù„Ø£Ø±Ø¶ÙŠØ© */
        .landmasses-svg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 4;
        }

        .landmass {
            fill: #4caf50;
            stroke: #388e3c;
            stroke-width: 1;
        }

        /* ØªØ³Ù…ÙŠØ§Øª Ø§Ù„ÙƒØªÙ„ Ø§Ù„Ø£Ø±Ø¶ÙŠØ© */
        .land-label {
            position: absolute;
            color: #0d47a1;
            font-weight: bold;
            font-size: 0.9rem;
            background: #ffffff;
            padding: 5px 10px;
            border-radius: 20px;
            border: 1px solid #bbdefb;
            box-shadow: 0 0 5px rgba(13, 71, 161, 0.1);
            z-index: 9;
            white-space: nowrap;
        }

        /* Ø¥Ø¶Ø§ÙØ© Ù†Ù…Ø· Ù„Ø¹Ù†ØµØ± canvas */
        #triangleCanvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 9;
        }

        /* Ø§Ù„ØªØ¬Ø§ÙˆØ¨ Ù…Ø¹ Ø£Ø­Ø¬Ø§Ù… Ø§Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„Ù…Ø®ØªÙ„ÙØ© */
        @media (max-width: 768px) {
            h1 {
                font-size: 2.5rem;
            }

            .subtitle {
                font-size: 1.1rem;
            }

            .ocean-container {
                height: 40vh;
            }

            .plane {
                font-size: 2.5rem;
            }

            .land-label {
                font-size: 0.7rem;
                padding: 3px 8px;
            }
            
            .point-label {
                font-size: 1rem;
                padding: 5px 15px;
            }
            
            .control-btn {
                padding: 10px 20px;
                font-size: 1rem;
            }
        }

        /* ÙƒÙˆØ¯ Ø§Ù„Ø¨Ø±Ø§Ù…ÙŠÙ„ Ø§Ù„Ø¬Ø¨Ø±ÙŠØ© */
        .algebra-container {
            background: #ffffff;
            border-radius: 15px;
            padding: 30px;
            margin: 20px 0;
            width: 100%;
            box-shadow: 0 5px 15px rgba(25, 118, 210, 0.1);
            border: 1px solid #e3f2fd;
        }

        .instructions {
            background: #e3f2fd;
            border-radius: 12px;
            padding: 15px;
            margin: 20px 0;
            border: 2px solid #bbdefb;
            font-size: 1rem;
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.05);
            color: #0d47a1;
        }

        .game-area {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-top: 25px;
        }

        .barrels-container, .third-box {
            background: #f5f5f5;
            border-radius: 15px;
            padding: 20px;
            min-height: 140px;
            border: 3px dashed #4caf50;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.05);
        }

        .third-box {
            border-color: #f57c00;
            background: #fff3e0;
            min-height: 180px;
        }

        .section-title {
            color: #2e7d32;
            font-size: 1.3rem;
            margin-top: 0;
            margin-bottom: 20px;
        }

        .third-box .section-title {
            color: #f57c00;
            font-size: 1.4rem;
        }

        .barrels-row {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 12px;
            margin-top: 15px;
        }

        .barrel {
            width: 65px;
            height: 85px;
            border-radius: 10px 10px 45px 45px;
            position: relative;
            cursor: grab;
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: bold;
            font-size: 1.4rem;
            color: #ffffff;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.15);
            transition: transform 0.2s, box-shadow 0.2s;
            border: 3px solid;
            user-select: none;
            touch-action: none;
        }

        .barrel-n {
            background: linear-gradient(to bottom, #795548, #5d4037);
            border-color: #4e342e;
        }

        .barrel-d {
            background: linear-gradient(to bottom, #5e35b1, #4527a0);
            border-color: #311b92;
        }
        
        .barrel.original-barrel {
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .barrel:hover {
            transform: scale(1.08);
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
        }

        .barrel:active {
            cursor: grabbing;
            transform: scale(1.08);
            box-shadow: 0 7px 14px rgba(0, 0, 0, 0.25);
        }

        .barrel::before, .barrel::after {
            content: '';
            position: absolute;
            width: 120%;
            height: 10px;
            left: -10%;
        }

        .barrel-n::before, .barrel-n::after {
            background: #4e342e;
        }

        .barrel-d::before, .barrel-d::after {
            background: #311b92;
        }

        .barrel::before {
            top: 25%;
        }

        .barrel::after {
            top: 65%;
        }
        
        /* Ù†Ù…Ø· Ø§Ù„Ø¨Ø±Ù…ÙŠÙ„ Ø§Ù„Ø°ÙŠ ÙŠØªÙ… Ø³Ø­Ø¨Ù‡ Ø­Ø§Ù„ÙŠÙ‹Ø§ */
        .dragging {
            opacity: 0.7;
            position: fixed; /* Ù„ØªØªØ¨Ø¹Ù‡ Ø§Ù„Ù…Ø¤Ø´Ø± Ø£Ùˆ Ø§Ù„Ø¥ØµØ¨Ø¹ */
            z-index: 9999;
            pointer-events: none; /* Ù„Ù…Ù†Ø¹ Ø§Ù„ØªÙØ§Ø¹Ù„ Ù…Ø¹ Ù†ÙØ³Ù‡ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø³Ø­Ø¨ */
            transition: none; /* Ù„Ù…Ù†Ø¹ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø³Ø­Ø¨ */
        }
        
        .ghost-barrel {
            opacity: 0.8;
            position: fixed;
            z-index: 9999;
            pointer-events: none;
            transition: none;
        }

        .third-box-content {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            gap: 15px;
            min-height: 140px;
            padding: 15px;
        }

        .third-box-expression {
            font-size: 1.6rem;
            font-weight: bold;
            color: #0d47a1;
            background: #e3f2fd;
            padding: 12px 20px;
            border-radius: 12px;
            min-width: 180px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            border: 2px solid #bbdefb;
            text-align: center;
        }

        .controls {
            margin-top: 25px;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
        }

        button {
            background: linear-gradient(to bottom, #0d47a1, #1565c0);
            color: white;
            border: none;
            padding: 12px 24px;
            font-size: 1.1rem;
            border-radius: 30px;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 3px 8px rgba(13, 71, 161, 0.2);
            min-width: 160px;
            flex: 1;
            font-weight: bold;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 12px rgba(13, 71, 161, 0.3);
        }

        button:active {
            transform: translateY(1px);
            box-shadow: 0 2px 5px rgba(13, 71, 161, 0.2);
        }

        .feedback {
            margin-top: 15px;
            font-size: 1.1rem;
            min-height: 40px;
            color: #0d47a1;
            padding: 10px;
            border-radius: 8px;
            background: #f5f5f5;
        }

        .examples {
            display: flex;
            flex-direction: column;
            margin-top: 25px;
            gap: 15px;
        }

        .example-box {
            background: #f5f5f5;
            border-radius: 12px;
            padding: 15px;
            border: 2px solid #bbdefb;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }

        .example-title {
            color: #1976d2;
            font-weight: bold;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .example-content {
            font-size: 0.95rem;
            line-height: 1.5;
            color: #0d47a1;
        }

        .variables-container {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-bottom: 20px;
        }

        .barrel-counter {
            display: inline-block;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 50%;
            width: 28px;
            height: 28px;
            line-height: 28px;
            text-align: center;
            margin: 0 5px;
            font-weight: bold;
            font-size: 1rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .third-box-barrels {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 12px;
            margin-top: 15px;
        }

        .third-box-barrel {
            transform: scale(0.95);
        }

        .third-box-active {
            background: #ffecb3 !important;
            border: 3px dashed #ffa000;
        }

        .barrel-counter-container {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 15px;
        }

        .counter-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 1.1rem;
            background: #f5f5f5;
            padding: 8px 15px;
            border-radius: 20px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            color: #0d47a1;
        }

        .counter-icon {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .counter-icon.n {
            background: #5d4037;
        }

        .counter-icon.d {
            background: #4527a0;
        }

        .drop-instruction {
            margin-top: 15px;
            padding: 10px;
            background: #ffecb3;
            border-radius: 10px;
            border: 2px dashed #ffa000;
            font-size: 1.1rem;
            color: #f57c00;
        }

        /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ù„Ù„Ø±Ù…ÙˆØ² Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ© */
        .katex-display {
            display: inline-block;
            margin: 0;
        }
        
        /* Ù‡Ø°Ø§ Ù‡Ùˆ Ø§Ù„ØªØºÙŠÙŠØ± Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ: KaTeX ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø¯Ø§Ø¦Ù…Ù‹Ø§ LTR */
        .katex {
            font-size: 1.6rem !important;
            direction: ltr !important;
        }
        
        /* Ù…Ù†Ø·Ù‚Ø© ÙÙ„ÙˆØ±ÙŠØ¯Ø§ Ø§Ù„Ø®Ø¶Ø±Ø§Ø¡ */
        .florida-area {
            position: absolute;
            width: 18%;
            height: 40%;
            left: 8%;
            top: 15%;
            background: rgba(76, 175, 80, 0.3);
            border: 2px solid #388e3c;
            border-radius: 10px;
            z-index: 5;
            display: flex;
            align-items: center;
            justify-content: center;
            pointer-events: none;
        }
        
        .florida-area::after {
            content: "ÙÙ„ÙˆØ±ÙŠØ¯Ø§";
            color: #2e7d32;
            font-weight: bold;
            font-size: 1.5rem;
            text-shadow: 0 0 5px white;
        }
    </style>
</head>

<body class="bg-gray-50 text-slate-800">
    <!-- Header with Tailwind styling -->
    <header class="container mx-auto px-4">
        <div class="container mx-auto px-4">
            <!-- ØªÙ… ØªØ­Ø¯ÙŠØ« Ù‡Ø°Ø§ Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ù„ÙŠÙƒÙˆÙ† Ø¨Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ø£Ø¨ÙŠØ¶ Ù…Ø¨Ø§Ø´Ø±Ø© -->
            <h1 class="text-4xl md:text-5xl lg:text-6xl font-extrabold tracking-wide drop-shadow-md">
                Ø¬Ù…Ø¹ Ø§Ù„Ù…Ù‚Ø§Ø¯ÙŠØ± Ø§Ù„Ø¬Ø¨Ø±ÙŠØ© ÙˆØ·Ø±Ø­Ù‡Ø§
            </h1>
            <p class="mt-4 text-lg md:text-xl lg:text-2xl font-light opacity-90">
                Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª _ Ø§Ù„ØµÙ Ø§Ù„Ø³Ø§Ø¨Ø¹
            </p>
        </div>
    </header>
    
    <div class="mystery-icons">
        <div class="mystery-icon">â“</div>
        <div class="mystery-icon">ğŸŒ€</div>
        <div class="mystery-icon">ğŸŒªï¸</div>
        <div class="mystery-icon">ğŸ’«</div>
        <div class="mystery-icon">ğŸ”</div>
    </div>
    <div class="depth-effect"></div>
    <div class="light-flash"></div>
    <div class="water-reflection"></div>
    <div class="water-surface"></div>
    <div class="disappear-effect"></div>
    
    <div class="container">
        
        <!-- Ù‚Ø³Ù… Ø§Ø³ØªÙƒØ´Ù: Ù…Ø«Ù„Ø« Ø¨Ø±Ù…ÙˆØ¯Ø§ -->
        <div class="lesson-content">
            <h2 class="lesson-title">Ø§Ø³ØªÙƒØ´Ù: Ù…Ø«Ù„Ø« Ø¨Ø±Ù…ÙˆØ¯Ø§</h2>
            <div class="concept-box">
                <div class="concept-title">Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ø§Ø³ØªÙƒØ´Ø§ÙÙŠ</div>
                <div class="concept-content">
                    Ù…Ø«Ù„Ø« Ø¨Ø±Ù…ÙˆØ¯Ø§ Ù…Ù†Ø·Ù‚Ø© Ø¬ØºØ±Ø§ÙÙŠØ© Ø¹Ù„Ù‰ Ø´ÙƒÙ„ Ù…Ø«Ù„Ø« Ù…ØªØ·Ø§Ø¨Ù‚ Ø§Ù„Ø£Ø¶Ù„Ø§Ø¹ ÙÙŠ Ø§Ù„Ù…Ø­ÙŠØ· Ø§Ù„Ø£Ø·Ù„Ø³ÙŠ.
                    Ø¥Ø°Ø§ Ø¹Ø¨Ø±Ù†Ø§ Ø¹Ù† Ø·ÙˆÙ„ Ø§Ù„Ø¶Ù„Ø¹ Ø§Ù„ÙˆØ§Ø­Ø¯ Ø¨Ø§Ù„Ù…Ù‚Ø¯Ø§Ø± Ø§Ù„Ø¬Ø¨Ø±ÙŠ <span dir="ltr">\( x+600 \)</span>ØŒ ÙÙ…Ø§ Ù…Ø­ÙŠØ· Ø§Ù„Ù…Ø«Ù„Ø« Ø¨Ø¯Ù„Ø§Ù„Ø© <span dir="ltr">\( x \)</span>ØŸ
                </div>
            </div>
            
            <div class="ocean-container" id="oceanContainer">
                <div class="ocean"></div>
                <div class="wave"></div>
                <div class="wave wave-2"></div>
                <!-- Ø¹Ù†ØµØ± Canvas Ù„Ø±Ø³Ù… Ø§Ù„Ø®Ø·ÙˆØ· -->
                <canvas id="triangleCanvas"></canvas>
                <!-- SVG Ù„Ù„ÙƒØªÙ„ Ø§Ù„Ø£Ø±Ø¶ÙŠØ© -->
                <svg class="landmasses-svg" viewBox="0 0 100 100">
                    <!-- Ø£Ù…Ø±ÙŠÙƒØ§ Ø§Ù„Ø´Ù…Ø§Ù„ÙŠØ© ÙˆÙÙ„ÙˆØ±ÙŠØ¯Ø§ -->
                    <path class="landmass" d="M5 0 L5 10 L12 12 L15 11 L18 13 L20 10 L23 11 L25 10 L27 12 L28 15 L26 17 L25 20 L22 22 L20 25 L18 27 L15 30 L10 35 L8 38 L8 40 L10 42 L13 44 L15 45 L17 48 L15 50 L10 50 L8 48 L6 45 L5 42 L5 40 L7 38 L7 35 L5 32 L3 30 L0 25 L0 0 Z" />
                    <!-- ÙƒÙˆØ¨Ø§ -->
                    <path class="landmass" d="M30 65 Q45 60 60 65 L65 67 Q68 70 65 72 Q60 75 55 75 L45 74 Q40 73 35 72 Z" />
                    <!-- Ø¬Ø²Ø± Ø§Ù„Ø¨Ø§Ù‡Ø§Ù…Ø§Ø³ -->
                    <path class="landmass" d="M30 45 L32 46 L35 45 L33 44 Z" />
                    <path class="landmass" d="M35 48 L37 49 L40 48 L38 47 Z" />
                    <!-- Ù‡ÙŠØ³Ø¨Ø§Ù†ÙŠÙˆÙ„Ø§ (Ù‡Ø§ÙŠØªÙŠ ÙˆØ¬Ù…Ù‡ÙˆØ±ÙŠØ© Ø§Ù„Ø¯ÙˆÙ…ÙŠÙ†ÙŠÙƒØ§Ù†) -->
                    <path class="landmass" d="M60 70 Q65 72 70 70 Q75 68 75 72 Q70 75 65 75 Z" />
                    <path class="landmass" d="M68 73 Q72 75 75 73 Q78 71 80 75 Q75 78 70 78 Z" />
                    <!-- Ø¬Ø§Ù…Ø§ÙŠÙƒØ§ -->
                    <path class="landmass" d="M35 80 Q40 82 45 80 Q50 78 45 77 Q40 76 35 80 Z" />
                    <!-- Ø¨ÙˆØ±ØªÙˆØ±ÙŠÙƒÙˆ (Ø¬Ø²ÙŠØ±Ø© ØµØºÙŠØ±Ø©) -->
                    <path class="landmass" d="M85 82 Q88 85 90 82 Q92 80 90 78 Q87 76 85 82 Z" />
                </svg>
                <!-- Ù†Ù‚Ø§Ø· Ø§Ù„Ù…Ø«Ù„Ø« -->
                <div class="point miami" id="miamiPoint"></div>
                <div class="point bermuda" id="bermudaPoint"></div>
                <div class="point puerto-rico" id="puertoRicoPoint"></div>
                <!-- ØªØ³Ù…ÙŠØ§Øª Ø§Ù„Ù†Ù‚Ø§Ø· -->
                <div class="point-label" id="miamiLabel">Ù…ÙŠØ§Ù…ÙŠØŒ ÙÙ„ÙˆØ±ÙŠØ¯Ø§</div>
                <div class="point-label" id="bermudaLabel">Ø¨Ø±Ù…ÙˆØ¯Ø§</div>
                <div class="point-label" id="puertoRicoLabel">Ø¨ÙˆØ±ØªÙˆØ±ÙŠÙƒÙˆ</div>
                <!-- ØªØ³Ù…ÙŠØ§Øª Ø§Ù„ÙƒØªÙ„ Ø§Ù„Ø£Ø±Ø¶ÙŠØ© -->
                <div class="land-label" id="usaLabel">Ø§Ù„ÙˆÙ„Ø§ÙŠØ§Øª Ø§Ù„Ù…ØªØ­Ø¯Ø©</div>
                <div class="land-label" id="floridaLabel">ÙÙ„ÙˆØ±ÙŠØ¯Ø§</div>
                <div class="land-label" id="cubaLabel">ÙƒÙˆØ¨Ø§</div>
                <div class="land-label" id="bahamasLabel">Ø§Ù„Ø¨Ø§Ù‡Ø§Ù…Ø§Ø³</div>
                <div class="land-label" id="haitiLabel">Ù‡Ø§ÙŠØªÙŠ</div>
                <div class="land-label" id="jamaicaLabel">Ø¬Ø§Ù…Ø§ÙŠÙƒØ§</div>
                <div class="land-label" id="puertoRicoLandLabel">Ø¨ÙˆØ±ØªÙˆØ±ÙŠÙƒÙˆ</div>
                <div class="plane" id="plane">âœˆï¸</div>
                
                <!-- Ù…Ù†Ø·Ù‚Ø© ÙÙ„ÙˆØ±ÙŠØ¯Ø§ Ø§Ù„Ø®Ø¶Ø±Ø§Ø¡ -->
                <div class="florida-area"></div>
            </div>
            
            <div class="controls">
                <button class="control-btn" id="resetBtn">
                    <i class="fas fa-sync-alt"></i> Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ´ØºÙŠÙ„
                </button>
                <button class="control-btn" id="speedBtn">
                    <i class="fas fa-tachometer-alt"></i> ØªØºÙŠÙŠØ± Ø§Ù„Ø³Ø±Ø¹Ø©
                </button>
                <button class="control-btn" id="addBtn">
                    <i class="fas fa-plus"></i> Ø¥Ø¶Ø§ÙØ© Ø·Ø§Ø¦Ø±Ø©
                </button>
            </div>
        </div>
        
        <!-- Ù‚Ø³Ù… ÙÙƒØ±Ø© Ø§Ù„Ø¯Ø±Ø³ -->
        <div class="lesson-content">
            <h2 class="lesson-title">  ÙÙƒØ±Ø© Ø§Ù„Ø¯Ø±Ø³: Ø¬Ù…Ø¹ Ø§Ù„Ù…Ù‚Ø§Ø¯ÙŠØ± Ø§Ù„Ø¬Ø¨Ø±ÙŠØ© ÙˆØ·Ø±Ø­Ù‡Ø§. ÙˆØªØ¨Ø³ÙŠØ· Ø§Ù„Ù…Ù‚Ø§Ø¯ÙŠØ± Ø§Ù„Ø¬Ø¨Ø±ÙŠØ©</h2>
            
            <div class="concept-box">
                <div class="concept-title">Ø§Ù„Ø­Ø¯ÙˆØ¯ Ø§Ù„Ø¬Ø¨Ø±ÙŠØ© Ø§Ù„Ù…ØªØ´Ø§Ø¨Ù‡Ø©</div>
                <div class="concept-content">
                    <span class="term">Ø§Ù„Ø­Ø¯ÙˆØ¯ Ø§Ù„Ø¬Ø¨Ø±ÙŠØ© Ø§Ù„Ù…ØªØ´Ø§Ø¨Ù‡Ø© (algebraic like terms)</span> Ù‡ÙŠ Ø­Ø¯ÙˆØ¯ ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ù†ÙØ³Ù‡Ø§ØŒ ÙˆØ¨Ø§Ù„Ø£Ø³Ø³ Ù†ÙØ³Ù‡Ø§.
                </div>
            </div>
            
            <!-- ØªÙ… ØªØ­Ø¯ÙŠØ« Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø³Ù… Ù„ÙŠØµØ¨Ø­ Ø¬Ø¯ÙˆÙ„Ø§Ù‹ ÙˆØ§Ø¶Ø­Ø§Ù‹ ÙˆÙ…Ù„ÙˆÙ†Ø§Ù‹ -->
            <div class="example-box p-6 bg-white border border-slate-200 rounded-xl shadow-lg">
                <div class="example-title text-center text-slate-800 text-2xl font-bold mb-6">
                    Ø£Ù…Ø«Ù„Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø­Ø¯ÙˆØ¯ Ø§Ù„Ù…ØªØ´Ø§Ø¨Ù‡Ø© ÙˆØºÙŠØ± Ø§Ù„Ù…ØªØ´Ø§Ø¨Ù‡Ø©
                </div>
                <div class="overflow-x-auto">
                    <table class="min-w-full divide-y divide-slate-200 rounded-lg overflow-hidden border border-slate-300">
                        <thead>
                            <tr>
                                <th scope="col" class="px-6 py-4 text-center text-lg font-bold text-emerald-800 uppercase tracking-wider bg-emerald-100 border-l border-slate-200">
                                    Ø§Ù„Ø­Ø¯ÙˆØ¯ Ø§Ù„Ù…ØªØ´Ø§Ø¨Ù‡Ø©
                                </th>
                                <th scope="col" class="px-6 py-4 text-center text-lg font-bold text-rose-800 uppercase tracking-wider bg-rose-100">
                                    Ø§Ù„Ø­Ø¯ÙˆØ¯ ØºÙŠØ± Ø§Ù„Ù…ØªØ´Ø§Ø¨Ù‡Ø©
                                </th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-slate-200">
                            <tr class="hover:bg-slate-50 transition-colors duration-150">
                                <td class="px-6 py-4 whitespace-nowrap text-center text-xl text-emerald-700 font-medium bg-emerald-50 border-l border-slate-200" dir="ltr">
                                    \( x, 34x, -5x \)
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-center text-xl text-rose-700 font-medium bg-rose-50" dir="ltr">
                                    \( x, x^3, x^5 \)
                                </td>
                            </tr>
                            <tr class="hover:bg-slate-50 transition-colors duration-150">
                                <td class="px-6 py-4 whitespace-nowrap text-center text-xl text-emerald-700 font-medium bg-emerald-50 border-l border-slate-200" dir="ltr">
                                    \( 17xy, -28xy, xy \)
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-center text-xl text-rose-700 font-medium bg-rose-50" dir="ltr">
                                    \( 17, xy, x \)
                                </td>
                            </tr>
                            <tr class="hover:bg-slate-50 transition-colors duration-150">
                                <td class="px-6 py-4 whitespace-nowrap text-center text-xl text-emerald-700 font-medium bg-emerald-50 border-l border-slate-200" dir="ltr">
                                    \( -4a^2b, 8a^2b, a^2b \)
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-center text-xl text-rose-700 font-medium bg-rose-50" dir="ltr">
                                    \( a^2b, ab^2 \)
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            
            <div class="concept-box">
                <div class="concept-title">ÙƒÙŠÙÙŠØ© ØªØ¨Ø³ÙŠØ· Ø§Ù„Ù…Ù‚Ø§Ø¯ÙŠØ± Ø§Ù„Ø¬Ø¨Ø±ÙŠØ©</div>
                <div class="concept-content">
                    ÙŠÙ…ÙƒÙ†Ù†Ø§ Ø¬Ù…Ø¹ Ø£ÙŠ Ø­Ø¯ÙŠÙ† Ù…ØªØ´Ø§Ø¨Ù‡ÙŠÙ† Ø£Ùˆ Ø·Ø±Ø­Ù‡Ù…Ø§ØŒ ÙˆØ°Ù„Ùƒ Ø¨Ø¬Ù…Ø¹ Ù…Ø¹Ø§Ù…Ù„ÙŠÙ‡Ù…Ø§ Ø£Ùˆ Ø·Ø±Ø­Ù‡Ù…Ø§ ÙÙ‚Ø· ÙˆØ¥Ø¨Ù‚Ø§Ø¡ Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª.
                    <div class="math-expression">
                        \( 3x + 4x = (3 + 4)x = 7x \)
                    </div>
                    <div class="math-expression">
                        \( 4x - 3x = (4 - 3)x = x \)
                    </div>
                    <div class="math-expression">
                        \( 9y^5 - y^5 = (9 - 1)y^5 = 8y^5 \)
                    </div>
                </div>
            </div>
            
            <div class="concept-box">
                <div class="concept-title">Ø£Ø¨Ø³Ø· ØµÙˆØ±Ø© Ù„Ù„Ù…Ù‚Ø¯Ø§Ø± Ø§Ù„Ø¬Ø¨Ø±ÙŠ</div>
                <div class="concept-content">
                    ÙŠÙƒÙˆÙ† Ø§Ù„Ù…Ù‚Ø¯Ø§Ø± Ø§Ù„Ø¬Ø¨Ø±ÙŠ ÙÙŠ Ø£Ø¨Ø³Ø· ØµÙˆØ±Ø© (simplest form) Ø¥Ø°Ø§ Ù„Ù… ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø£ÙŠ Ø­Ø¯ÙˆØ¯ Ù…ØªØ´Ø§Ø¨Ù‡Ø©.
                </div>
            </div>
        </div>
        
        <!-- Ù‚Ø³Ù… Ø§Ù„Ø¨Ø±Ø§Ù…ÙŠÙ„ Ø§Ù„Ø¬Ø¨Ø±ÙŠØ© Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠ -->
        <div class="algebra-container">
            <h2 class="lesson-title">Ø§Ù„ØªÙ…Ø±ÙŠÙ† Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠ: ØªØ¨Ø³ÙŠØ· Ø§Ù„Ù…Ù‚Ø§Ø¯ÙŠØ± Ø§Ù„Ø¬Ø¨Ø±ÙŠØ©</h2>
            
            <div class="instructions">
                <p>Ø§Ø³Ø­Ø¨ Ø§Ù„Ø¨Ø±Ø§Ù…ÙŠÙ„ Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø³ØªØ·ÙŠÙ„ Ø§Ù„Ø¨Ø±ØªÙ‚Ø§Ù„ÙŠ Ù„Ø¨Ù†Ø§Ø¡ ØªØ¹Ø¨ÙŠØ± Ø¬Ø¨Ø±ÙŠ</p>
                <p>Ø§Ù„Ø¨Ø±Ø§Ù…ÙŠÙ„ Ø§Ù„Ø¨Ù†ÙŠØ©: Ø§Ù„Ù…ØªØºÙŠØ± n | Ø§Ù„Ø¨Ø±Ø§Ù…ÙŠÙ„ Ø§Ù„Ø¨Ù†ÙØ³Ø¬ÙŠØ©: Ø§Ù„Ù…ØªØºÙŠØ± d</p>
                <p style="color: #f57c00; font-weight: bold; font-size: 1.1rem;">ØªÙ… Ø²ÙŠØ§Ø¯Ø© Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ø¥ÙÙ„Ø§Øª Ù„ØªÙƒÙˆÙ† Ø£Ø³Ù‡Ù„ ÙÙŠ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…</p>
            </div>
            
            <div class="variables-container">
                <div class="barrels-container">
                    <h3 class="section-title">Ø¨Ø±Ø§Ù…ÙŠÙ„ Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª</h3>
                    <div class="barrels-row" id="originalBarrels">
                        <div class="barrel barrel-n original-barrel" data-type="n">n</div>
                        <div class="barrel barrel-n original-barrel" data-type="n">n</div>
                        <div class="barrel barrel-n original-barrel" data-type="n">n</div>
                        <div class="barrel barrel-d original-barrel" data-type="d">d</div>
                        <div class="barrel barrel-d original-barrel" data-type="d">d</div>
                        <div class="barrel barrel-d original-barrel" data-type="d">d</div>
                        <div class="barrel barrel-d original-barrel" data-type="d">d</div>
                        <div class="barrel barrel-d original-barrel" data-type="d">d</div>
                    </div>
                </div>
            </div>
            
            <div class="game-area">
                <div class="third-box" id="thirdBox">
                    <h3 class="section-title">Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø¥ÙÙ„Ø§Øª Ø§Ù„ÙƒØ¨ÙŠØ±Ø©</h3>
                    <div class="third-box-content" id="thirdBoxContent">
                        <!-- Ø§Ù„ØªØ¹Ø¨ÙŠØ± Ø§Ù„Ø¬Ø¨Ø±ÙŠ Ø³ÙŠØ¸Ù‡Ø± Ù‡Ù†Ø§ -->
                        <!-- ØªÙ… Ø¥Ø¶Ø§ÙØ© dir="ltr" Ù„Ù‡Ø°Ø§ Ø§Ù„Ø¹Ù†ØµØ± -->
                        <div class="third-box-expression" id="thirdBoxExpression" dir="ltr">\( 0 \)</div>
                        <div class="third-box-barrels" id="thirdBoxBarrels"></div>
                    </div>
                    <div class="drop-instruction">Ø£Ø³Ù‚Ø· Ø§Ù„Ø¨Ø±Ø§Ù…ÙŠÙ„ Ù‡Ù†Ø§ (Ù…Ø³Ø§Ø­Ø© ÙƒØ¨ÙŠØ±Ø© Ù„Ù„Ø¥ÙÙ„Ø§Øª)</div>
                    <div class="feedback" id="thirdBoxFeedback">Ø§Ø³Ø­Ø¨ Ø§Ù„Ø¨Ø±Ø§Ù…ÙŠÙ„ Ø¥Ù„Ù‰ Ù‡Ø°Ù‡ Ø§Ù„Ù…Ù†Ø·Ù‚Ø© Ø§Ù„ÙˆØ§Ø³Ø¹Ø©</div>
                    <div class="barrel-counter-container">
                        <div class="counter-item">
                            <div class="counter-icon n"></div>
                            <span>n: <span id="nCounter">0</span></span>
                        </div>
                        <div class="counter-item">
                            <div class="counter-icon d"></div>
                            <span>d: <span id="dCounter">0</span></span>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="examples">
                <div class="example-box">
                    <div class="example-title">Ø£Ù…Ø«Ù„Ø© Ø¹Ù„Ù‰ Ø§Ù„ØªØ¹Ø¨ÙŠØ±Ø§Øª Ø§Ù„Ø¬Ø¨Ø±ÙŠØ©</div>
                    <div class="example-content">
                        <p dir="ltr">\( 2n + 3d \)</p>
                        <p dir="ltr">\( 4n - d \)</p>
                        <p dir="ltr">\( n + 5d \)</p>
                    </div>
                </div>
                <div class="example-box">
                    <div class="example-title">ÙƒÙŠÙÙŠØ© ØªØ¨Ø³ÙŠØ· Ø§Ù„Ù…Ù‚Ø§Ø¯ÙŠØ±</div>
                    <div class="example-content">
                        <p dir="ltr">\( 3n + 2n = 5n \)</p>
                        <p dir="ltr">\( 4d - d = 3d \)</p>
                        <p dir="ltr">\( 2n + 3d + n = 3n + 3d \)</p>
                    </div>
                </div>
            </div>
            
            <div class="controls">
                <button id="addAlgebraBtn">Ø¥Ø¶Ø§ÙØ© Ø¨Ø±Ù…ÙŠÙ„</button>
                <button id="resetAlgebraBtn">Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†</button>
            </div>
        </div>
        
        <!-- Ø²Ø± Ø§Ù„ØªØ§Ù„ÙŠ ÙÙŠ Ù†Ù‡Ø§ÙŠØ© Ø§Ù„ØµÙØ­Ø© -->
        <div class="controls">
            <a href="u2l4p2.html" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-4 px-8 rounded-full shadow-lg transition duration-300 ease-in-out transform hover:scale-105 flex items-center justify-center gap-2 text-xl md:text-2xl mt-8">
                <i class="fas fa-arrow-right"></i> Ø§Ù„ØªØ§Ù„ÙŠ
            </a>
        </div>
    </div>

    <!-- Ù…ÙƒØªØ¨Ø© KaTeX Ù„Ù„Ø±Ù…ÙˆØ² Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ© -->
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // ØªÙ‡ÙŠØ¦Ø© KaTeX Ù„ØªØµÙŠÙŠØ± Ø§Ù„Ø±Ù…ÙˆØ² Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ©
            renderMathInElement(document.body, {
                delimiters: [
                    {left: "\\(", right: "\\)", display: false},
                    {left: "\\[", right: "\\]", display: true}
                ],
                throwOnError: false
            });
            
            // ========= ÙƒÙˆØ¯ Ù…Ø«Ù„Ø« Ø¨Ø±Ù…ÙˆØ¯Ø§ =========
            const points = document.querySelectorAll('.point');
            const plane = document.getElementById('plane');
            const resetBtn = document.getElementById('resetBtn');
            const speedBtn = document.getElementById('speedBtn');
            const addBtn = document.getElementById('addBtn');
            const oceanContainer = document.getElementById('oceanContainer');

            // Ù…ØªØºÙŠØ±Ø§Øª Ø®Ø§ØµØ© Ø¨Ø±Ø³Ù… Ø§Ù„Ù…Ø«Ù„Ø«
            const canvas = document.getElementById('triangleCanvas');
            const ctx = canvas.getContext('2d');
            const miamiPoint = document.getElementById('miamiPoint');
            const bermudaPoint = document.getElementById('bermudaPoint');
            const puertoRicoPoint = document.getElementById('puertoRicoPoint');

            // ØªØ³Ù…ÙŠØ§Øª Ø§Ù„Ù†Ù‚Ø§Ø·
            const miamiLabel = document.getElementById('miamiLabel');
            const bermudaLabel = document.getElementById('bermudaLabel');
            const puertoRicoLabel = document.getElementById('puertoRicoLabel');
            
            // ØªØ³Ù…ÙŠØ§Øª Ø§Ù„ÙƒØªÙ„ Ø§Ù„Ø£Ø±Ø¶ÙŠØ©
            const usaLabel = document.getElementById('usaLabel');
            const floridaLabel = document.getElementById('floridaLabel');
            const cubaLabel = document.getElementById('cubaLabel');
            const bahamasLabel = document.getElementById('bahamasLabel');
            const haitiLabel = document.getElementById('haitiLabel');
            const jamaicaLabel = document.getElementById('jamaicaLabel');
            const puertoRicoLandLabel = document.getElementById('puertoRicoLandLabel');

            let animationSpeed = 1;

            // ÙˆØ¸ÙŠÙØ© Ù„ØªØ­Ø¯ÙŠØ¯ Ù…ÙˆØ§Ù‚Ø¹ Ø§Ù„Ù†Ù‚Ø§Ø· ÙˆØ§Ù„ØªØ³Ù…ÙŠØ§Øª Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠÙ‹Ø§
            function updateTrianglePoints() {
                const width = oceanContainer.clientWidth;
                const height = oceanContainer.clientHeight;
                
                // ØªØ­Ø¯ÙŠØ¯ Ù…ÙˆØ§Ù‚Ø¹ Ø±Ø¤ÙˆØ³ Ø§Ù„Ù…Ø«Ù„Ø« ÙƒÙ†Ø³Ø¨ Ù…Ø¦ÙˆÙŠØ©
                const triangleSize = Math.min(width, height) * 0.35;
                const centerX = width / 2;
                const centerY = height / 2;
                
                // Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª Ø§Ù„Ù†Ù‚Ø§Ø· (Ù…ØªØ·Ø§Ø¨Ù‚ Ø§Ù„Ø£Ø¶Ù„Ø§Ø¹) - Ù…Ø¹ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©
                // ØªÙ… ØªØ¹Ø¯ÙŠÙ„ Ù…ÙˆÙ‚Ø¹ Ù†Ù‚Ø·Ø© Ù…ÙŠØ§Ù…ÙŠ Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø®Ø¶Ø±Ø§Ø¡ (ÙÙ„ÙˆØ±ÙŠØ¯Ø§)
                // ØªÙ… ØªØ¹Ø¯ÙŠÙ„ Ù‡Ø°Ø§ Ø§Ù„Ø³Ø·Ø± Ù„ØªØ­Ø±ÙŠÙƒ Ø§Ù„Ù†Ù‚Ø·Ø© Ø¥Ù„Ù‰ Ø§Ù„ØºØ±Ø¨ (Ù†Ø§Ù‚Øµ Ù‚ÙŠÙ…Ø© Ø£ÙƒØ¨Ø±)
                const miamiX = centerX - triangleSize * 0.95;
                const miamiY = centerY - triangleSize * 0.15;
                
                // ØªÙ… ØªØ­Ø±ÙŠÙƒ Ù†Ù‚Ø·Ø© Ø¨Ø±Ù…ÙˆØ¯Ø§ Ø´Ù…Ø§Ù„Ø§Ù‹ ÙˆØ´Ø±Ù‚Ø§Ù‹ Ø¨Ù…Ù‚Ø¯Ø§Ø± 30% Ù…Ù† Ø­Ø¬Ù… Ø§Ù„Ù…Ø«Ù„Ø«
                const moveDistanceX = 0.35 * triangleSize;
                const moveDistanceY = 0.25 * triangleSize;
                
                const bermudaX = centerX + moveDistanceX;
                const bermudaY = centerY - triangleSize * 0.5 - moveDistanceY;
                
                const puertoRicoX = centerX + triangleSize * 0.6;
                const puertoRicoY = centerY + triangleSize * 0.6;

                // ØªØ­Ø¯ÙŠØ« Ù…ÙˆØ§Ù‚Ø¹ Ø§Ù„Ù†Ù‚Ø§Ø·
                miamiPoint.style.left = `${miamiX}px`;
                miamiPoint.style.top = `${miamiY}px`;
                
                bermudaPoint.style.left = `${bermudaX}px`;
                bermudaPoint.style.top = `${bermudaY}px`;
                
                puertoRicoPoint.style.left = `${puertoRicoX}px`;
                puertoRicoPoint.style.top = `${puertoRicoY}px`;
                
                // ØªØ­Ø¯ÙŠØ« Ù…ÙˆØ§Ù‚Ø¹ ØªØ³Ù…ÙŠØ§Øª Ø§Ù„Ù†Ù‚Ø§Ø·
                miamiLabel.style.left = `${miamiX - 40}px`;
                miamiLabel.style.top = `${miamiY - 30}px`;
                
                bermudaLabel.style.left = `${bermudaX}px`;
                bermudaLabel.style.top = `${bermudaY - 30}px`;
                
                puertoRicoLabel.style.left = `${puertoRicoX - 50}px`;
                puertoRicoLabel.style.top = `${puertoRicoY + 20}px`;
                
                // ØªØ­Ø¯ÙŠØ« Ù…ÙˆØ§Ù‚Ø¹ ØªØ³Ù…ÙŠØ§Øª Ø§Ù„ÙƒØªÙ„ Ø§Ù„Ø£Ø±Ø¶ÙŠØ©
                usaLabel.style.left = `${width * 0.1}px`;
                usaLabel.style.top = `${height * 0.15}px`;
                
                floridaLabel.style.left = `${width * 0.1}px`;
                floridaLabel.style.top = `${height * 0.4}px`;
                
                cubaLabel.style.left = `${width * 0.35}px`;
                cubaLabel.style.top = `${height * 0.55}px`;
                
                bahamasLabel.style.left = `${width * 0.4}px`;
                bahamasLabel.style.top = `${height * 0.35}px`;
                
                haitiLabel.style.left = `${width * 0.58}px`;
                haitiLabel.style.top = `${height * 0.6}px`;
                
                jamaicaLabel.style.left = `${width * 0.35}px`;
                jamaicaLabel.style.top = `${height * 0.68}px`;
                
                puertoRicoLandLabel.style.left = `${width * 0.75}px`;
                puertoRicoLandLabel.style.top = `${height * 0.7}px`;
                
                // Ø¥Ø¹Ø§Ø¯Ø© Ø±Ø³Ù… Ø§Ù„Ù…Ø«Ù„Ø«
                drawTriangle();
            }

            // ÙˆØ¸ÙŠÙØ© Ù„Ø±Ø³Ù… Ø§Ù„Ù…Ø«Ù„Ø«
            function drawTriangle() {
                // Ø¶Ø¨Ø· Ø£Ø¨Ø¹Ø§Ø¯ Ø§Ù„Ù€ canvas Ù„ØªÙ†Ø§Ø³Ø¨ Ø­Ø¬Ù… Ø§Ù„Ø­Ø§ÙˆÙŠØ©
                canvas.width = oceanContainer.clientWidth;
                canvas.height = oceanContainer.clientHeight;

                // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª Ø§Ù„Ù†Ù‚Ø§Ø·
                const miamiRect = miamiPoint.getBoundingClientRect();
                const bermudaRect = bermudaPoint.getBoundingClientRect();
                const puertoRicoRect = puertoRicoPoint.getBoundingClientRect();
                const oceanRect = oceanContainer.getBoundingClientRect();

                // Ø­Ø³Ø§Ø¨ Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª Ù…Ø±ÙƒØ² ÙƒÙ„ Ù†Ù‚Ø·Ø© Ø¨Ø§Ù„Ù†Ø³Ø¨Ø© Ù„Ù„Ø­Ø§ÙˆÙŠØ©
                const miamiX = miamiRect.left - oceanRect.left + miamiRect.width / 2;
                const miamiY = miamiRect.top - oceanRect.top + miamiRect.height / 2;
                const bermudaX = bermudaRect.left - oceanRect.left + bermudaRect.width / 2;
                const bermudaY = bermudaRect.top - oceanRect.top + bermudaRect.height / 2;
                const puertoRicoX = puertoRicoRect.left - oceanRect.left + puertoRicoRect.width / 2;
                const puertoRicoY = puertoRicoRect.top - oceanRect.top + puertoRicoRect.height / 2;

                // Ù…Ø³Ø­ Ø§Ù„Ù€ canvas Ù‚Ø¨Ù„ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø±Ø³Ù…
                ctx.clearRect(0, 0, canvas.width, canvas.height);

                // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø®Ø·
                ctx.strokeStyle = '#0d47a1';
                ctx.lineWidth = 4;
                ctx.shadowColor = '#0d47a1';
                ctx.shadowBlur = 15;

                // Ø±Ø³Ù… Ø§Ù„Ø®Ø·ÙˆØ·
                ctx.beginPath();
                ctx.moveTo(miamiX, miamiY);
                ctx.lineTo(bermudaX, bermudaY);
                ctx.lineTo(puertoRicoX, puertoRicoY);
                ctx.closePath();
                ctx.stroke();

                // Ø¥Ø¹Ø§Ø¯Ø© Ø±Ø³Ù… Ø§Ù„Ø®Ø·ÙˆØ· Ø¨Ø¹Ø¯ ÙØªØ±Ø© Ø²Ù…Ù†ÙŠØ© Ù‚ØµÙŠØ±Ø© Ù„ØªØ­Ø¯ÙŠØ« ØªØ£Ø«ÙŠØ± Ø§Ù„Ø¸Ù„
                setTimeout(() => {
                    ctx.beginPath();
                    ctx.moveTo(miamiX, miamiY);
                    ctx.lineTo(bermudaX, bermudaY);
                    ctx.lineTo(puertoRicoX, puertoRicoY);
                    ctx.closePath();
                    ctx.stroke();
                }, 50);
            }

            // ÙˆØ¸ÙŠÙØ© Ù„Ø¥Ù†Ø´Ø§Ø¡ ÙÙ‚Ø§Ø¹Ø§Øª Ø¹Ø´ÙˆØ§Ø¦ÙŠØ©
            function createBubbles() {
                setInterval(() => {
                    const bubble = document.createElement('div');
                    bubble.className = 'bubble';
                    const size = Math.random() * 40 + 15;
                    bubble.style.width = `${size}px`;
                    bubble.style.height = `${size}px`;
                    const left = Math.random() * 100;
                    bubble.style.left = `${left}%`;
                    bubble.style.bottom = `-${size}px`;
                    const duration = Math.random() * 15 + 10;
                    bubble.style.animationDuration = `${duration}s`;
                    const delay = Math.random() * 5;
                    bubble.style.animationDelay = `${delay}s`;
                    oceanContainer.appendChild(bubble);
                    setTimeout(() => {
                        bubble.remove();
                    }, duration * 1000);
                }, 500);
            }

            // ÙˆØ¸ÙŠÙØ© Ù„Ø¥Ø¶Ø§ÙØ© Ø·Ø§Ø¦Ø±Ø© Ø¥Ø¶Ø§ÙÙŠØ©
            function addExtraPlane() {
                const newPlane = document.createElement('div');
                newPlane.className = 'plane';
                newPlane.textContent = 'âœˆï¸';
                newPlane.style.fontSize = '2.5rem';
                newPlane.style.top = `${Math.random() * 30 + 15}%`;
                newPlane.style.left = `${Math.random() * 30 + 10}%`;
                newPlane.style.animation = `fly ${20 / animationSpeed}s infinite`;
                oceanContainer.appendChild(newPlane);
            }

            // ÙˆØ¸ÙŠÙØ© Ù„Ø¥Ø¶Ø§ÙØ© ÙˆÙ…Ø¶Ø§Øª Ø¶ÙˆØ¦ÙŠØ©
            function addLightFlashes() {
                setInterval(() => {
                    const flash = document.createElement('div');
                    flash.className = 'light-flash';
                    const top = Math.random() * 100;
                    const left = Math.random() * 100;
                    flash.style.top = `${top}%`;
                    flash.style.left = `${left}%`;
                    const size = Math.random() * 200 + 100;
                    flash.style.width = `${size}px`;
                    flash.style.height = `${size}px`;
                    oceanContainer.appendChild(flash);
                    setTimeout(() => {
                        flash.remove();
                    }, 15000);
                }, 5000);
            }

            // ØªØ£Ø«ÙŠØ± Ø§Ù„Ù†Ø¨Ø¶ Ù„Ù„Ù†Ù‚Ø§Ø·
            setInterval(() => {
                points.forEach(point => {
                    point.style.boxShadow = `0 0 ${15 + Math.random() * 10}px rgba(211, 47, 47, ${0.5 + Math.random() * 0.3})`;
                });
            }, 1500);

            // ÙˆØ¸ÙŠÙØ© Ø²Ø± Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ´ØºÙŠÙ„
            resetBtn.addEventListener('click', function() {
                plane.style.animation = 'none';
                document.querySelectorAll('.plane').forEach(p => {
                    if (p !== plane) p.remove();
                });
                plane.style.top = '30%';
                plane.style.left = '30%';
                setTimeout(() => {
                    plane.style.animation = `fly ${20 / animationSpeed}s infinite`;
                }, 10);
            });

            // ÙˆØ¸ÙŠÙØ© Ø²Ø± ØªØºÙŠÙŠØ± Ø§Ù„Ø³Ø±Ø¹Ø©
            speedBtn.addEventListener('click', function() {
                animationSpeed = animationSpeed === 1 ? 2 : 0.5;
                if (animationSpeed === 2) {
                    this.innerHTML = '<i class="fas fa-tachometer-alt"></i> Ø³Ø±Ø¹Ø© Ø¹Ø§Ø¯ÙŠØ©';
                } else if (animationSpeed === 0.5) {
                    this.innerHTML = '<i class="fas fa-tachometer-alt"></i> Ø³Ø±Ø¹Ø© Ø¨Ø·ÙŠØ¦Ø©';
                } else {
                    this.innerHTML = '<i class="fas fa-tachometer-alt"></i> Ø³Ø±Ø¹Ø© Ø³Ø±ÙŠØ¹Ø©';
                }
                plane.style.animation = `fly ${20 / animationSpeed}s infinite`;
                document.querySelectorAll('.plane').forEach(p => {
                    if (p !== plane) {
                        p.style.animation = `fly ${20 / animationSpeed}s infinite`;
                    }
                });
            });

            // ÙˆØ¸ÙŠÙØ© Ø²Ø± Ø¥Ø¶Ø§ÙØ© Ø·Ø§Ø¦Ø±Ø©
            addBtn.addEventListener('click', addExtraPlane);

            // Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ ÙˆØ¸ÙŠÙØ© Ø±Ø³Ù… Ø§Ù„Ù…Ø«Ù„Ø« Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø© ÙˆØ¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø­Ø¬Ù…Ù‡Ø§
            window.addEventListener('load', function() {
                updateTrianglePoints();
                createBubbles();
                addLightFlashes();
            });
            window.addEventListener('resize', updateTrianglePoints);

            // ========= ÙƒÙˆØ¯ Ø§Ù„Ø¨Ø±Ø§Ù…ÙŠÙ„ Ø§Ù„Ø¬Ø¨Ø±ÙŠØ© (ØªÙ… Ø§Ù„ØªØ¹Ø¯ÙŠÙ„) =========
            const originalBarrels = document.getElementById('originalBarrels');
            const thirdBox = document.getElementById('thirdBox');
            const thirdBoxExpression = document.getElementById('thirdBoxExpression');
            const thirdBoxFeedback = document.getElementById('thirdBoxFeedback');
            const thirdBoxBarrels = document.getElementById('thirdBoxBarrels');
            const nCounter = document.getElementById('nCounter');
            const dCounter = document.getElementById('dCounter');
            const resetAlgebraBtn = document.getElementById('resetAlgebraBtn');
            const addAlgebraBtn = document.getElementById('addAlgebraBtn'); // ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ù‡Ø°Ø§ Ø§Ù„Ø²Ø± Ù…ÙˆØ¬ÙˆØ¯ ÙÙŠ HTML

            
            let thirdBoxCountN = 0;
            let thirdBoxCountD = 0;
            let draggedItem = null;
            let ghostBarrel = null;

            // Ø¯Ø§Ù„Ø© Ù„Ø¥Ø¹Ø¯Ø§Ø¯ Ø£Ø­Ø¯Ø§Ø« Ø§Ù„Ø³Ø­Ø¨ ÙˆØ§Ù„Ø¥ÙÙ„Ø§Øª Ù„Ù„Ø¨Ø±Ø§Ù…ÙŠÙ„ Ø§Ù„Ø£ØµÙ„ÙŠØ©
            function setupDragEvents(barrel) {
                // Ø£Ø­Ø¯Ø§Ø« Ø³Ø­Ø¨ Ø§Ù„ÙØ£Ø±Ø©
                barrel.addEventListener('mousedown', startDrag);
                barrel.addEventListener('mouseup', endDrag);

                // Ø£Ø­Ø¯Ø§Ø« Ø³Ø­Ø¨ Ø§Ù„Ù„Ù…Ø³
                barrel.addEventListener('touchstart', startDrag, { passive: false });
                barrel.addEventListener('touchend', endDrag);
            }

            // Ø¯Ø§Ù„Ø© Ø¨Ø¯Ø¡ Ø§Ù„Ø³Ø­Ø¨
            function startDrag(e) {
                e.preventDefault(); // Ù…Ù†Ø¹ Ø§Ù„Ø³Ù„ÙˆÙƒ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ Ù„Ù„Ù…ØªØµÙØ­ Ù…Ø«Ù„ ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù†Øµ

                const barrel = this;
                const rect = barrel.getBoundingClientRect();
                const offsetX = e.clientX ? e.clientX - rect.left : e.touches[0].clientX - rect.left;
                const offsetY = e.clientY ? e.clientY - rect.top : e.touches[0].clientY - rect.top;

                // Ø¥Ù†Ø´Ø§Ø¡ Ø¨Ø±Ù…ÙŠÙ„ Ø´Ø¨Ø­ÙŠ (ghost barrel) ÙŠØªØ¨Ø¹ Ø§Ù„Ù…Ø¤Ø´Ø±/Ø§Ù„Ø¥ØµØ¨Ø¹
                ghostBarrel = barrel.cloneNode(true);
                ghostBarrel.classList.add('ghost-barrel');
                ghostBarrel.style.width = `${rect.width}px`;
                ghostBarrel.style.height = `${rect.height}px`;
                document.body.appendChild(ghostBarrel);
                
                // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø¨Ø±Ù…ÙŠÙ„ Ø§Ù„Ø£ØµÙ„ÙŠ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø³Ø­Ø¨
                barrel.style.visibility = 'hidden';

                draggedItem = barrel;

                // Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹ Ù„Ø­Ø±ÙƒØ© Ø§Ù„Ù…Ø¤Ø´Ø±/Ø§Ù„Ù„Ù…Ø³ Ù„ØªØ­Ø¯ÙŠØ« Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¨Ø±Ù…ÙŠÙ„ Ø§Ù„Ø´Ø¨Ø­ÙŠ
                document.addEventListener('mousemove', moveDrag);
                document.addEventListener('touchmove', moveDrag, { passive: false });
            }

            // Ø¯Ø§Ù„Ø© ØªØ­Ø¯ÙŠØ« Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¨Ø±Ù…ÙŠÙ„ Ø§Ù„Ø´Ø¨Ø­ÙŠ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø³Ø­Ø¨
            function moveDrag(e) {
                if (!ghostBarrel) return;

                const clientX = e.clientX || e.touches[0].clientX;
                const clientY = e.clientY || e.touches[0].clientY;

                // ØªØ­Ø¯ÙŠØ« Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¨Ø±Ù…ÙŠÙ„ Ø§Ù„Ø´Ø¨Ø­ÙŠ
                ghostBarrel.style.left = `${clientX - ghostBarrel.offsetWidth / 2}px`;
                ghostBarrel.style.top = `${clientY - ghostBarrel.offsetHeight / 2}px`;
            }

            // Ø¯Ø§Ù„Ø© Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ø³Ø­Ø¨
            function endDrag(e) {
                if (!draggedItem) return;

                // Ø¥Ø²Ø§Ù„Ø© Ù…Ø³ØªÙ…Ø¹Ø§Øª Ø§Ù„Ø£Ø­Ø¯Ø§Ø«
                document.removeEventListener('mousemove', moveDrag);
                document.removeEventListener('touchmove', moveDrag);

                const clientX = e.clientX || (e.changedTouches ? e.changedTouches[0].clientX : null);
                const clientY = e.clientY || (e.changedTouches ? e.changedTouches[0].clientY : null);

                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¥ÙÙ„Ø§Øª
                const dropTarget = clientX !== null && clientY !== null ? document.elementFromPoint(clientX, clientY) : null;
                const thirdBoxRect = thirdBox.getBoundingClientRect();
                
                // ØªØ­Ù‚Ù‚ Ù…Ù…Ø§ Ø¥Ø°Ø§ ØªÙ… Ø§Ù„Ø¥ÙÙ„Ø§Øª Ø¯Ø§Ø®Ù„ Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø¥ÙÙ„Ø§Øª Ø§Ù„Ø¨Ø±ØªÙ‚Ø§Ù„ÙŠØ©
                if (dropTarget && thirdBox.contains(dropTarget) || isOverlapping(clientX, clientY, thirdBoxRect)) {
                    handleBarrelDrop(draggedItem.getAttribute('data-type'));
                }

                // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø¨Ø±Ù…ÙŠÙ„ Ø§Ù„Ø£ØµÙ„ÙŠ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰
                draggedItem.style.visibility = 'visible';
                
                // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø¨Ø±Ù…ÙŠÙ„ Ø§Ù„Ø´Ø¨Ø­ÙŠ
                if (ghostBarrel) {
                    ghostBarrel.remove();
                    ghostBarrel = null;
                }
                
                draggedItem = null;
                thirdBox.classList.remove('third-box-active');
            }

            // Ø¯Ø§Ù„Ø© Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØªØ¯Ø§Ø®Ù„
            function isOverlapping(x, y, rect) {
                return x >= rect.left && x <= rect.right && y >= rect.top && y <= rect.bottom;
            }

            // Ø¯Ø§Ù„Ø© Ù„Ù…Ø¹Ø§Ù„Ø¬Ø© Ø¥ÙÙ„Ø§Øª Ø§Ù„Ø¨Ø±Ù…ÙŠÙ„
            function handleBarrelDrop(barrelType) {
                // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø¨Ø±Ù…ÙŠÙ„ Ø§Ù„Ø£ØµÙ„ÙŠ Ù…Ù† Ø§Ù„Ù…Ø³ØªØ·ÙŠÙ„ Ø§Ù„Ø¹Ù„ÙˆÙŠ
                if (draggedItem && draggedItem.parentNode === originalBarrels) {
                    draggedItem.remove();
                    thirdBoxFeedback.textContent = `ØªÙ… Ù†Ù‚Ù„ Ø¨Ø±Ù…ÙŠÙ„ ${barrelType} Ø¥Ù„Ù‰ Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø¥ÙÙ„Ø§Øª Ø§Ù„ÙƒØ¨ÙŠØ±Ø©`;
                } else {
                    thirdBoxFeedback.textContent = `ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø¨Ø±Ù…ÙŠÙ„ ${barrelType} Ø¥Ù„Ù‰ Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø¥ÙÙ„Ø§Øª Ø§Ù„ÙƒØ¨ÙŠØ±Ø©`;
                }
                
                // Ø¥Ø¶Ø§ÙØ© Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø³ØªØ·ÙŠÙ„ Ø§Ù„Ø«Ø§Ù„Ø«
                if (barrelType === 'n') thirdBoxCountN++;
                else if (barrelType === 'd') thirdBoxCountD++;
                
                updateThirdBox();
                
                // Ø¥Ù†Ø´Ø§Ø¡ Ù†Ø³Ø®Ø© Ù…Ù† Ø§Ù„Ø¨Ø±Ù…ÙŠÙ„ ÙˆØ¥Ø¶Ø§ÙØªÙ‡Ø§ Ù„Ù„Ù…Ø³ØªØ·ÙŠÙ„ Ø§Ù„Ø«Ø§Ù„Ø«
                const newBarrel = document.createElement('div');
                newBarrel.className = `barrel barrel-${barrelType} third-box-barrel`;
                newBarrel.textContent = barrelType;
                newBarrel.setAttribute('data-type', barrelType);
                
                // Ø¬Ø¹Ù„ Ø§Ù„Ø¨Ø±Ù…ÙŠÙ„ Ø§Ù„Ø¬Ø¯ÙŠØ¯ Ù‚Ø§Ø¨Ù„Ø§Ù‹ Ù„Ù„Ø³Ø­Ø¨ Ø£ÙŠØ¶Ù‹Ø§
                setupDragEvents(newBarrel);
                
                thirdBoxBarrels.appendChild(newBarrel);
                
                thirdBoxFeedback.style.color = barrelType === 'n' ? '#5d4037' : '#4527a0';
                
                // ØªØ£Ø«ÙŠØ± Ù…Ø±Ø¦ÙŠ
                thirdBox.style.transform = 'scale(1.05)';
                setTimeout(() => thirdBox.style.transform = 'scale(1)', 300);
            }

            // Ø¯Ø§Ù„Ø© ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø³ØªØ·ÙŠÙ„ Ø§Ù„Ø«Ø§Ù„Ø«
            function updateThirdBox() {
                const expression = formatThirdExpression();
                thirdBoxExpression.innerHTML = `\\( ${expression} \\)`;
                nCounter.textContent = thirdBoxCountN;
                dCounter.textContent = thirdBoxCountD;
                updateExpressionColor(thirdBoxExpression, thirdBoxCountN + thirdBoxCountD);
                
                // Ø¥Ø¹Ø§Ø¯Ø© ØªØµÙŠÙŠØ± KaTeX
                renderMathInElement(thirdBoxExpression, {
                    delimiters: [
                        {left: "\\(", right: "\\)", display: false}
                    ],
                    throwOnError: false
                });
            }
            
            // Ø¯Ø§Ù„Ø© Ù„ØªÙ†Ø³ÙŠÙ‚ ØªØ¹Ø¨ÙŠØ± Ø§Ù„Ù…Ø³ØªØ·ÙŠÙ„ Ø§Ù„Ø«Ø§Ù„Ø« (ØªÙ… Ø§Ù„ØªØ¹Ø¯ÙŠÙ„)
            function formatThirdExpression() {
                let parts = [];
                if (thirdBoxCountN > 0) {
                    parts.push(`${thirdBoxCountN}n`);
                }
                if (thirdBoxCountD > 0) {
                    parts.push(`${thirdBoxCountD}d`);
                }
                
                if (parts.length === 0) {
                    return '0';
                }
                
                return parts.join(' + ');
            }
            
            // Ø¯Ø§Ù„Ø© Ù„ØªØ­Ø¯ÙŠØ¯ Ù„ÙˆÙ† Ø§Ù„ØªØ¹Ø¨ÙŠØ± Ø­Ø³Ø¨ Ø¹Ø¯Ø¯ Ø§Ù„Ø¨Ø±Ø§Ù…ÙŠÙ„
            function updateExpressionColor(element, count) {
                if (count === 0) {
                    element.style.color = '#0d47a1';
                } else if (count < 3) {
                    element.style.color = '#1976d2';
                } else if (count < 6) {
                    element.style.color = '#2196f3';
                } else {
                    element.style.color = '#64b5f6';
                }
            }
            
            // Ø²Ø± Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù…Ø³ØªØ·ÙŠÙ„ Ø§Ù„Ø«Ø§Ù„Ø«
            resetAlgebraBtn.addEventListener('click', function() {
                // Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¨Ø±Ø§Ù…ÙŠÙ„ Ø§Ù„Ø£ØµÙ„ÙŠØ©
                resetOriginalBarrels();
                
                // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù…Ø³ØªØ·ÙŠÙ„ Ø§Ù„Ø¨Ø±ØªÙ‚Ø§Ù„ÙŠ
                resetThirdBox();
                
                thirdBoxFeedback.textContent = 'ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† ÙƒÙ„ Ø´ÙŠØ¡';
                thirdBoxFeedback.style.color = '#0d47a1';
            });
            
            // Ø¯Ø§Ù„Ø© Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù…Ø³ØªØ·ÙŠÙ„ Ø§Ù„Ø«Ø§Ù„Ø«
            function resetThirdBox() {
                thirdBoxCountN = 0;
                thirdBoxCountD = 0;
                thirdBoxBarrels.innerHTML = '';
                updateThirdBox();
            }
            
            // Ø¯Ø§Ù„Ø© Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¨Ø±Ø§Ù…ÙŠÙ„ Ø§Ù„Ø£ØµÙ„ÙŠØ©
            function resetOriginalBarrels() {
                // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø¨Ø±Ø§Ù…ÙŠÙ„ Ø§Ù„Ø­Ø§Ù„ÙŠØ©
                originalBarrels.innerHTML = '';
                
                // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¨Ø±Ø§Ù…ÙŠÙ„ Ø§Ù„Ø£ØµÙ„ÙŠØ© Ù…Ù† Ø¬Ø¯ÙŠØ¯
                for (let i = 0; i < 3; i++) {
                    const barrel = document.createElement('div');
                    barrel.className = 'barrel barrel-n original-barrel';
                    barrel.textContent = 'n';
                    barrel.setAttribute('data-type', 'n');
                    setupDragEvents(barrel);
                    originalBarrels.appendChild(barrel);
                }
                
                for (let i = 0; i < 5; i++) {
                    const barrel = document.createElement('div');
                    barrel.className = 'barrel barrel-d original-barrel';
                    barrel.textContent = 'd';
                    barrel.setAttribute('data-type', 'd');
                    setupDragEvents(barrel);
                    originalBarrels.appendChild(barrel);
                }
            }
            
            // Ø¥Ø¹Ø¯Ø§Ø¯ Ø£Ø­Ø¯Ø§Ø« Ø§Ù„Ø³Ø­Ø¨ ÙˆØ§Ù„Ø¥ÙÙ„Ø§Øª Ù„Ù„Ø¨Ø±Ø§Ù…ÙŠÙ„ Ø§Ù„Ø£ØµÙ„ÙŠØ© Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
            document.querySelectorAll('.original-barrel').forEach(barrel => {
                setupDragEvents(barrel);
            });
            
            // Ø¥Ø¶Ø§ÙØ© ÙˆØ¥Ø²Ø§Ù„Ø© ÙØ¦Ø© Ø§Ù„ØªÙ†Ø´ÙŠØ· Ø¹Ù†Ø¯ Ø§Ù„Ø³Ø­Ø¨ ÙÙˆÙ‚ Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø¥ÙÙ„Ø§Øª
            thirdBox.addEventListener('dragover', (e) => {
                e.preventDefault();
                thirdBox.classList.add('third-box-active');
            });
            
            thirdBox.addEventListener('dragleave', () => {
                thirdBox.classList.remove('third-box-active');
            });
            
            thirdBox.addEventListener('drop', (e) => {
                e.preventDefault();
                thirdBox.classList.remove('third-box-active');
                if (draggedItem) {
                    const barrelType = draggedItem.getAttribute('data-type');
                    handleBarrelDrop(barrelType);
                    draggedItem = null;
                }
            });
            
            // Ø¯Ø¹Ù… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¨Ø±Ø§Ù…ÙŠÙ„ ÙŠØ¯ÙˆÙŠÙ‹Ø§ (Ø§Ù„Ø²Ø±)
            addAlgebraBtn.addEventListener('click', function() {
                // ... (Ù†ÙØ³ Ø§Ù„Ù…Ù†Ø·Ù‚ Ø§Ù„Ù‚Ø¯ÙŠÙ… Ù‡Ù†Ø§)
                const type = prompt('Ø£Ø¯Ø®Ù„ Ù†ÙˆØ¹ Ø§Ù„Ø¨Ø±Ù…ÙŠÙ„ (n Ø£Ùˆ d):');
                if (type === 'n' || type === 'd') {
                    if (type === 'n') thirdBoxCountN++;
                    else if (type === 'd') thirdBoxCountD++;
                    
                    const newBarrel = document.createElement('div');
                    newBarrel.className = `barrel barrel-${type} third-box-barrel`;
                    newBarrel.textContent = type;
                    newBarrel.setAttribute('data-type', type);
                    setupDragEvents(newBarrel);
                    thirdBoxBarrels.appendChild(newBarrel);

                    updateThirdBox();
                    
                    thirdBoxFeedback.textContent = `ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø¨Ø±Ù…ÙŠÙ„ ${type} ÙŠØ¯ÙˆÙŠÙ‹Ø§.`;
                    thirdBoxFeedback.style.color = type === 'n' ? '#5d4037' : '#4527a0';
                } else {
                    thirdBoxFeedback.textContent = 'Ø§Ù„Ù†ÙˆØ¹ ØºÙŠØ± ØµØ­ÙŠØ­! ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† n Ø£Ùˆ d';
                    thirdBoxFeedback.style.color = '#f44336';
                }
            });
        });
    </script>
</body>
</html>

